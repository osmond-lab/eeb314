
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../lecture-06/">
      
      
        <link rel="next" href="../lecture-08/">
      
      
      <link rel="icon" href="../../images/favicon_non_transparent.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>Lecture 7 - Mathematical modelling in ecology and evolution (EEB314)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


  
  
    
      
      
      
    
  
  
  <style>:root{.md-tag{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M5.5%207A1.5%201.5%200%200%201%204%205.5%201.5%201.5%200%200%201%205.5%204%201.5%201.5%200%200%201%207%205.5%201.5%201.5%200%200%201%205.5%207m15.91%204.58-9-9C12.05%202.22%2011.55%202%2011%202H4c-1.11%200-2%20.89-2%202v7c0%20.55.22%201.05.59%201.41l8.99%209c.37.36.87.59%201.42.59s1.05-.23%201.41-.59l7-7c.37-.36.59-.86.59-1.41%200-.56-.23-1.06-.59-1.42%22/%3E%3C/svg%3E');}}</style>

    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lecture-7-finding-equilibria-in-linear-multivariate-models" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Mathematical modelling in ecology and evolution (EEB314)" class="md-header__button md-logo" aria-label="Mathematical modelling in ecology and evolution (EEB314)" data-md-component="logo">
      
  <img src="../../images/favicon_non_transparent.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Mathematical modelling in ecology and evolution (EEB314)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lecture 7
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="purple"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Overview

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../syllabus/course_structure/" class="md-tabs__link">
          
  
  
  Syllabus

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../schedule/" class="md-tabs__link">
          
  
  
  Lectures

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../labs/schedule/" class="md-tabs__link">
          
  
  
  Labs

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../acknowledgements/" class="md-tabs__link">
        
  
  
    
  
  Acknowledgements

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Mathematical modelling in ecology and evolution (EEB314)" class="md-nav__button md-logo" aria-label="Mathematical modelling in ecology and evolution (EEB314)" data-md-component="logo">
      
  <img src="../../images/favicon_non_transparent.svg" alt="logo">

    </a>
    Mathematical modelling in ecology and evolution (EEB314)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Syllabus
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Syllabus
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/course_structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Course structure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/instructors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Instructors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/when_and_where/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    When and where
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/textbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Textbook
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/final_project/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Final Project
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/previous_tests/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Previous Tests
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/general_info/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    General info
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Other resources
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Lectures
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Lectures
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schedule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schedule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-03/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-04/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 4
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-05/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 5
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-06/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 6
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Lecture 7
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Lecture 7
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lecture-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-motivation" class="md-nav__link">
    <span class="md-ellipsis">
      1. Motivation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-matrix-inversion" class="md-nav__link">
    <span class="md-ellipsis">
      2. Matrix inversion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Matrix inversion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#determinant" class="md-nav__link">
    <span class="md-ellipsis">
      Determinant
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inverting" class="md-nav__link">
    <span class="md-ellipsis">
      Inverting
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-solving-for-equilibrium" class="md-nav__link">
    <span class="md-ellipsis">
      3. Solving for equilibrium
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-solving-for-equilibrium-when-singular" class="md-nav__link">
    <span class="md-ellipsis">
      4. Solving for equilibrium when singular
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-summary" class="md-nav__link">
    <span class="md-ellipsis">
      5. Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-08/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 8
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-09/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 9
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 10
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Labs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/schedule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schedule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/tutorial-01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/tutorial-02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/tutorial-03/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/tutorial-04/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 4
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/tutorial-05/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 5
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/tutorial-06/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 6
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../acknowledgements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Acknowledgements
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lecture-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-motivation" class="md-nav__link">
    <span class="md-ellipsis">
      1. Motivation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-matrix-inversion" class="md-nav__link">
    <span class="md-ellipsis">
      2. Matrix inversion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Matrix inversion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#determinant" class="md-nav__link">
    <span class="md-ellipsis">
      Determinant
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inverting" class="md-nav__link">
    <span class="md-ellipsis">
      Inverting
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-solving-for-equilibrium" class="md-nav__link">
    <span class="md-ellipsis">
      3. Solving for equilibrium
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-solving-for-equilibrium-when-singular" class="md-nav__link">
    <span class="md-ellipsis">
      4. Solving for equilibrium when singular
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-summary" class="md-nav__link">
    <span class="md-ellipsis">
      5. Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<script type="text/x-thebe-config">
  {
      requestKernel: true,
      mountActivateWidget: true,
      mountStatusWidget: true,
      binderOptions: {
      repo: "mmosmond/executable-cells",
      ref: "main",
      },
  }
</script>
<script src="https://unpkg.com/thebe@latest/lib/index.js"></script>
<p><link rel="stylesheet" href="https://unpkg.com/thebe@latest/lib/thebe.css"></p>
<h1 id="lecture-7-finding-equilibria-in-linear-multivariate-models">Lecture 7: Finding equilibria in linear multivariate models</h1>
<hr style="margin-bottom: 0em;">
<center>
<div class="inrow">
    Run notes interactively?
    <div style="float: left;" class="thebe-activate"></div>
    <div class="thebe-status"></div>
</div>
</center>
<hr style="margin-top: 0em;">

<h2 id="lecture-overview">Lecture overview</h2>
<ol>
<li><a href="#section1">Motivation</a></li>
<li><a href="#section2">Matrix inversion</a></li>
<li><a href="#section3">Solving for equilibrium</a></li>
<li><a href="#section4">Solving for equilibrium when singular</a></li>
<li><a href="#section5">Summary</a></li>
</ol>
<p><span id='section1'></span></p>
<h2 id="1-motivation">1. Motivation</h2>
<hr>

<p>We now know that we can represent our linear multivariate model for the number of birds on two islands in matrix form,</p>
<div class="arithmatex">\[
\frac{\mathrm{d}\vec{n}}{\mathrm{d}t} = \mathbf{M}\vec{n} + \vec{m},
\]</div>
<p>where </p>
<div class="arithmatex">\[
\begin{aligned}
\vec{n} &amp;= \begin{pmatrix} n_1 \\ n_2 \end{pmatrix}\\
\mathbf{M} &amp;= \begin{pmatrix} b_1 - d_1 - m_{21} &amp; m_{12} \\ m_{21} &amp; b_2 - d_2 - m_{12} \end{pmatrix}\\
\vec{m} &amp;= \begin{pmatrix} m_1 \\ m_2 \end{pmatrix},
\end{aligned}
\]</div>
<p>with <span class="arithmatex">\(n_i\)</span> the number of birds on island <span class="arithmatex">\(i\)</span> at time <span class="arithmatex">\(t\)</span>, <span class="arithmatex">\(b_i\)</span> the birth rate on island <span class="arithmatex">\(i\)</span>, <span class="arithmatex">\(d_i\)</span> the death rate on island <span class="arithmatex">\(i\)</span>, <span class="arithmatex">\(m_{ij}\)</span> the rate at which birds on island <span class="arithmatex">\(j\)</span> migrate to island <span class="arithmatex">\(i\)</span>, and <span class="arithmatex">\(m_i\)</span> the rate at which birds arrive to island <span class="arithmatex">\(i\)</span> from elsewhere.</p>
<p>Next we would like to solve for the equilibria. We can start by setting the differential equation to 0 and subtracting <span class="arithmatex">\(\vec{m}\)</span> from both sides,</p>
<div class="arithmatex">\[
\begin{align*}
0 &amp;= \mathbf{M}\hat{\vec{n}} + \vec{m}\\
-\vec{m} &amp;= \mathbf{M}\hat{\vec{n}}.
\end{align*}
\]</div>
<p>Now to isolate our variable, <span class="arithmatex">\(\hat{\vec{n}}\)</span>, we effectively need to move <span class="arithmatex">\(\mathbf{M}\)</span> to the other side of the equation. In normal algebra we would simply divide both sides by <span class="arithmatex">\(\mathbf{M}\)</span>. But note that in the last lecture we discussed matrix addition and multiplication. We did not yet discuss division. This is because for matrices there is no such thing as division. The analogy is the <strong>inverse</strong>.</p>
<p><span id='section2'></span></p>
<h2 id="2-matrix-inversion">2. Matrix inversion</h2>
<hr>

<p>A square <span class="arithmatex">\(m\times m\)</span> matrix <span class="arithmatex">\(\mathbf{M}\)</span> is <strong>invertible</strong> if it may be multiplied by another matrix to get the identity matrix.  We call this second matrix, <span class="arithmatex">\(\mathbf{M}^{-1}\)</span>, the <strong>inverse</strong> of the first,</p>
<div class="arithmatex">\[
\mathbf{M}\mathbf{M}^{-1} = \mathbf{I} = \mathbf{M}^{-1}\mathbf{M}.
\]</div>
<p>Geometrically, the inverse reverses the stretching and rotating that the original matrix does to a vector,</p>
<div class="arithmatex">\[
\mathbf{M}^{-1}(\mathbf{M}\vec{v}) = (\mathbf{M}^{-1}\mathbf{M})\vec{v} = \mathbf{I}\vec{v} = \vec{v}.
\]</div>
<p>There are rules to find the inverse of a matrix when it is invertible. To know if a matrix is invertible we can calculate the determinant.</p>
<h3 id="determinant">Determinant</h3>
<p>The <strong>determinant</strong> of a <span class="arithmatex">\(2 \times 2\)</span> matrix is</p>
<div class="arithmatex">\[
\begin{equation*}
\text{Det}\left(
\begin{pmatrix}
  a &amp; b \\
  c &amp; d
\end{pmatrix}\right)
=
\begin{vmatrix}
  a &amp; b\\
  c &amp; d
\end{vmatrix}
=ad-bc.
\end{equation*}
\]</div>
<p>In principle we can calculate the determinant of any square matrix. The determinant of an <span class="arithmatex">\(n \times n\)</span> matrix can be obtained by working along the first row, multiplying the first element of the first row by the determinant of the matrix created by deleting the first row and first column <em>minus</em> the second element of the first row times the determinant of the matrix created by deleting the first row and second column <em>plus</em> the third element... and so on. </p>
<p>For example, </p>
<div class="arithmatex">\[
\begin{equation*}
\begin{vmatrix}
  a &amp; b &amp; c \\
  d &amp; e &amp; f\\
  g &amp; h &amp; i
\end{vmatrix}
= a \begin{vmatrix}
  e &amp; f\\
  h &amp; i
\end{vmatrix}
- b \begin{vmatrix}
  d &amp; f\\
  g &amp; i
\end{vmatrix}
+ c \begin{vmatrix}
  d &amp; e\\
  g &amp; h
\end{vmatrix}.
\end{equation*}
\]</div>
<p>More generally we can perform this technique along any row or any column. The trick is remembering which terms are added and which are subtracted. One way to remember is: if both the row <span class="arithmatex">\(i\)</span> and column <span class="arithmatex">\(j\)</span> are even or both are odd then the term multiplied by the element at that position, <span class="arithmatex">\(m_{ij}\)</span>, gets a plus, otherwise it gets a minus.  </p>
<details>
<summary>General formula for determinants</summary>
<p>Moving along any row <span class="arithmatex">\(i\)</span>,</p>
<div class="arithmatex">\[
|\mathbf{M}| = (-1)^{i+1}\sum_{j=1}^{n}(-1)^{j+1}m_{ij}  |\mathbf{M}_{ij}|.
\]</div>
<p>Moving along column <span class="arithmatex">\(j\)</span>,</p>
<div class="arithmatex">\[
|\mathbf{M}| = (-1)^{j+1}\sum_{i=1}^{n}(-1)^{i+1}m_{ij}  |\mathbf{M}_{ij}|.
\]</div>
</details>
<p>A few useful rules emerge from this method:</p>
<ul>
<li>the determinant of a matrix is the same as the determinant of its transpose, <span class="arithmatex">\(|\mathbf{M}| = |\mathbf{M}^\intercal|\)</span>,</li>
<li>the determinant of a diagonal or triangular matrix is the product of the diagonal elements, <span class="arithmatex">\(|\mathbf{M}| = \prod_{i=1}^n m_{ii} = m_{11}m_{22}\cdots m_{nn}\)</span>,</li>
<li>the determinant of a block-diagonal or block-triangular matrix is the product of the determinants of the diagonal submatrices.</li>
</ul>
<p>It also suggests that rows or columns with lots of zeros are very helpful when calculating the determinant, for example,</p>
<div class="arithmatex">\[
\begin{aligned}
\begin{vmatrix}
  m_{11} &amp; m_{12} &amp; m{13} \\
  m_{21} &amp; 0 &amp; 0 \\
  m_{31} &amp; m_{32} &amp; m_{33} \\
\end{vmatrix}
= 
- m_{21} 
\begin{vmatrix}
  m_{12} &amp; m_{13} \\
  m_{32} &amp; m_{33} \\
\end{vmatrix}.
\end{aligned}
\]</div>
<p>Now, why does the determinant tell us anything about whether a matrix is invertible? Well, when the determinant is zero, <span class="arithmatex">\(|\mathbf{M}|=0\)</span>, it means that the rows are not linearly independent, that is, some row <span class="arithmatex">\(\vec{r}_k\)</span> can be written as <span class="arithmatex">\(a_1 \vec{r}_1 + \cdots + a_{k-1} \vec{r}_{k-1} + a_{k+1} \vec{r}_{k+1} + \cdots + a_n \vec{r}_n\)</span>, where the <span class="arithmatex">\(a_i\)</span> are scalars and the <span class="arithmatex">\(\vec{r}_i\)</span> are the rows of <span class="arithmatex">\(\mathbf{M}\)</span>. As a result, when we multiply a vector by a matrix with a determinant of zero we lose some information and therefore cannot reverse the operation. This is analagous to mutliplying by 0 in normal algebra -- if we multiply a bunch of different numbers by zero we have no way of reversing the operation to know what the original numbers were. So, a matrix is invertible if and only if it has a nonzero determinant, <span class="arithmatex">\(|\mathbf{M}|\neq0\)</span>. Matrices that are not invertible are called <strong>singular</strong>.</p>
<p>Geometrically, mutliplying multiple vectors by a matrix whose deteriminant is zero causes them to fall along a line. Below we multiply the two black vectors by a matrix whose determinant is zero to get the two red vectors, which fall along the same line. We have lost information and cannot undue the operation to recover the original vectors.</p>
<pre data-executable="true" data-language="python">
import matplotlib.pyplot as plt #import plotting library
from sympy import *

v1 = Matrix([[2],[1]]) #column vector 1
v2 = Matrix([[1],[1]]) #column vector 2
M = Matrix([[1/2,1],[1,2]]) #matrix with determinant of zero

#original vectors
for v in [v1,v2]:
    plt.arrow(0, 0, #starting x and y values of arrow
              float(v[0]), float(v[1]), #change in x and y 
              head_width=0.1, color='black', length_includes_head=True) #aesthetics

#stretched and rotated vectors
for v in [M*v1,M*v2]:
    plt.arrow(0, 0, #starting x and y values of arrow
              float(v[0]), float(v[1]), #change in x and y 
              head_width=0.1, color='red', length_includes_head=True) #aesthetics

plt.xlim(0,5) #set bounds on x axis
plt.ylim(0,5) #set bounds on y axis
plt.show()
</pre>

<p><img alt="png" src="../lecture-07_files/lecture-07_2_0.png" /></p>
<h3 id="inverting">Inverting</h3>
<p>Now back to how to find the inverse of a matrix.</p>
<p>For an invertible 2x2 matrix we do the following</p>
<div class="arithmatex">\[
\begin{align}
\mathbf{M}^{-1} 
=&amp;\begin{pmatrix}
  a &amp; b \\
  c &amp; d
\end{pmatrix}^{-1}\\
&amp;=\frac{1}{|\mathbf{M}|}
\begin{pmatrix}
  d  &amp; -b \\
  -c &amp; a
\end{pmatrix}\\
&amp;=\frac{1}{ad-bc}
\begin{pmatrix}
  d  &amp; -b \\
  -c &amp; a
\end{pmatrix}\\
&amp;=
\begin{pmatrix}
  \frac{d}{ad-bc}  &amp; \frac{-b}{ad-bc} \\
  \frac{-c}{ad-bc} &amp; \frac{a}{ad-bc}
\end{pmatrix}
\end{align}
\]</div>
<p>Larger matrices are more difficult to invert by hand. One exception is if they are diagonal, in which case we simply invert each of the diagonal elements,</p>
<div class="arithmatex">\[
\mathbf{M}^{-1} = 
\begin{pmatrix}
1/m_{11} &amp; 0 &amp; \cdots &amp; 0\\
0 &amp; 1/m_{22} &amp; \cdots &amp; 0\\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots\\
0 &amp; 0 &amp; \cdots &amp; 1/m_{nn}
\end{pmatrix}.
\]</div>
<p><span id='section3'></span></p>
<h2 id="3-solving-for-equilibrium">3. Solving for equilibrium</h2>
<hr>

<p>OK, now let's return to our model of birds on islands,  </p>
<div class="arithmatex">\[
\frac{\mathrm{d}\vec{n}}{\mathrm{d}t} = \mathbf{M}\vec{n} + \vec{m},
\]</div>
<p>and solve for the equilibria, <span class="arithmatex">\(\hat{\vec{n}}\)</span>. </p>
<p>We do this by setting the rate of change to zero <span class="arithmatex">\(\frac{\mathrm{d}\vec{n}}{\mathrm{d}t}=0\)</span>, subtracting <span class="arithmatex">\(\vec{m}\)</span> from both sides, and multiplying by the inverse matrix <span class="arithmatex">\(\mathbf{M}^{-1}\)</span> on the left:</p>
<div class="arithmatex">\[
\begin{align*}
0 &amp;= \mathbf{M}\hat{\vec{n}} + \vec{m}\\
-\vec{m} &amp;= \mathbf{M}\hat{\vec{n}}\\
-\mathbf{M}^{-1}\vec{m} &amp;= \mathbf{M}^{-1}\mathbf{M}\hat{\vec{n}}\\
-\mathbf{M}^{-1}\vec{m} &amp;= \mathbf{I}\hat{\vec{n}}\\
-\mathbf{M}^{-1}\vec{m} &amp;= \hat{\vec{n}}.
\end{align*}
\]</div>
<p>We can write the left hand side in terms of our parameters by calculating the inverse of this 2x2 matrix and multiplying by the vector</p>
<div class="arithmatex">\[
\begin{align}
\hat{\vec{n}} 
&amp;=-\mathbf{M}^{-1}\vec{m}\\
&amp;=-\frac{1}{|\mathbf{M}|}
\begin{pmatrix} b_2 - d_2 - m_{12} &amp; -m_{12} \\ -m_{21} &amp; b_1 - d_1 - m_{21} \end{pmatrix}
\begin{pmatrix} m_1 \\ m_2 \end{pmatrix}\\
&amp;= -\frac{1}{(b_1 - d_1 - m_{21})(b_2 - d_2 - m_{12})-m_{21}m_{12}} \begin{pmatrix} (b_2 - d_2 - m_{12})m_1 -m_{12}m_2 \\ -m_{21}m_1 + (b_1 - d_1 - m_{21})m_2 \end{pmatrix}\\
&amp;= \begin{pmatrix} -\frac{(b_2 - d_2 - m_{12})m_1 -m_{12}m_2}{(b_1 - d_1 - m_{21})(b_2 - d_2 - m_{12})-m_{21}m_{12}} \\ -\frac{-m_{21}m_1 + (b_1 - d_1 - m_{21})m_2}{(b_1 - d_1 - m_{21})(b_2 - d_2 - m_{12})-m_{21}m_{12}} \end{pmatrix}
\end{align}
\]</div>
<p>Ta-da! Using linear algebra we solved for both equilibria, <span class="arithmatex">\(\hat{n}_1\)</span> and <span class="arithmatex">\(\hat{n}_2\)</span>, with a single equation. </p>
<p>We can visualize this equilibrium as the intersection of the <strong>nullclines</strong>, which are the values of the variables that make the change in each variable zero. In this case we can solve for the nullclines in terms of <span class="arithmatex">\(n_2\)</span>,</p>
<div class="arithmatex">\[
\begin{align}
\frac{\mathrm{d}n_1}{\mathrm{d}t} &amp;= 0\\
(b_1 - d_1 - m_{21})n_1 + m_{12} n_2 + m_1 &amp;= 0\\
m_{12} n_2 &amp;= -m_1 - (b_1 - d_1 - m_{21})n_1\\
n_2 &amp;= \frac{-m_1 - (b_1 - d_1 - m_{21})n_1}{m_{12}}
\end{align}
\]</div>
<p>and</p>
<div class="arithmatex">\[
\begin{align}
\frac{\mathrm{d}n_2}{\mathrm{d}t} &amp;= 0\\
(b_2 - d_2 - m_{12})n_2 + m_{21} n_1 + m_2 &amp;= 0\\
(b_2 - d_2 - m_{12})n_2  &amp;= -m_{21} n_1 - m_2\\
n_2  &amp;= \frac{-m_{21} n_1 - m_2}{b_2 - d_2 - m_{12}},
\end{align}
\]</div>
<p>and plot them as functions of <span class="arithmatex">\(n_1\)</span>. Our predicted equilibrium correctly lands right on the intersection of the two nullclines.</p>
<pre data-executable="true" data-language="python">
import matplotlib.pyplot as plt
from sympy import *
import numpy as np

# define the variables
n1, n2 = symbols('n1, n2')

# Choose the parameter values
b1, b2 = 1, 1
d1, d2 = 1.1, 1.1
m12, m21 = 0.05, 0.05
m1, m2 = 5, 5

# define differential equations
dn1dt = (b1 - d1 - m12) * n1 + m21 * n2 + m1
dn2dt = m12 * n1 + (b2 - d2 - m21) * n2 + m2

# get the nullclines
nullcline_1 = solve(Eq(dn1dt, 0),n2)[0]
nullcline_2 = solve(Eq(dn2dt, 0),n2)[0]

# plot
n1s = np.linspace(0,100,100)
plt.plot(n1s, [nullcline_1.subs(n1,i) for i in n1s], label='$n_1$ nullcline')
plt.plot(n1s, [nullcline_2.subs(n1,i) for i in n1s], label='$n_2$ nullcline')

# add predicted equilibrium
n1eq = -((b2-d2-m21)*m1-m21*m2)/((b1-d1-m12)*(b2-d2-m21)-m21*m12)
n2eq = -(-m12*m1+(b1-d1-m12)*m2)/((b1-d1-m12)*(b2-d2-m21)-m21*m12)
plt.scatter(n1eq,n2eq, color='k', zorder=2, s=100, label='equilibrium')

plt.xlabel('number of birds on island 1, $n_1$')
plt.ylabel('number of birds on island 2, $n_2$')
plt.xlim(0,100)
plt.ylim(0,100)
plt.legend()
plt.show()
</pre>

<p><img alt="png" src="../lecture-07_files/lecture-07_5_0.png" /></p>
<p><span id='section4'></span></p>
<h2 id="4-solving-for-equilibrium-when-singular">4. Solving for equilibrium when singular</h2>
<hr>

<p>Now, if our matrix <span class="arithmatex">\(\mathbf{M}\)</span> is singular we can still try to solve for equilibrium, we just can't use matrix algebra. Instead we try to simultaneously solve all equations. We've nearly done this above with the nullclines already. Setting the two nullclines equal to one another to find their intersection,</p>
<div class="arithmatex">\[
\begin{align}
\frac{-m_1 - (b_1 - d_1 - m_{21})\hat{n}_1}{m_{12}} &amp;= \frac{-m_{21} \hat{n}_1 - m_2}{b_2 - d_2 - m_{12}}\\
(-m_1 - (b_1 - d_1 - m_{21})\hat{n}_1)(b_2 - d_2 - m_{12}) &amp;= (-m_{21} \hat{n}_1 - m_2)m_{12}\\
(m_{21}m_{12}-(b_1 - d_1 - m_{21})(b_2 - d_2 - m_{12}))\hat{n}_1 &amp;= - m_2m_{12} + m_1(b_2 - d_2 - m_{12})\\
-|\mathbf{M}|\hat{n}_1 &amp;= - m_2m_{12} + m_1(b_2 - d_2 - m_{12})\\
0 &amp;= - m_2m_{12} + m_1(b_2 - d_2 - m_{12}).
\end{align}
\]</div>
<p>This is either true or not true, regardless of <span class="arithmatex">\(n_1\)</span> and <span class="arithmatex">\(n_2\)</span>. This means that the two nullclines intersect everywhere or nowhere, which implies there are either infinite equilibria (along the shared nullcline) or no equilibria.</p>
<p>Below is a scenario where there are no equilibria, in which case the nullclines never cross because they are parallel to one another.</p>
<pre data-executable="true" data-language="python">
import matplotlib.pyplot as plt
from sympy import *
import numpy as np

# define the variables
n1, n2 = symbols('n1, n2')

# choose the parameter values
b1, b2 = 1.1, 1
d1, d2 = 1.01, 1.01
m12 = 0.5
m21 = (b1 - d1)*(b2 - d2 - m12)/(m12 + (b2 - d2 - m12)) #forces zero determinant
m1 = 5
delta = 10 #0 for infinite equilibria, nonzero for no equilibria
m2 = m1*(b2 - d2 - m12)/m12 + delta

# define differential equations
dn1dt = (b1 - d1 - m21) * n1 + m12 * n2 + m1
dn2dt = m21 * n1 + (b2 - d2 - m12) * n2 + m2

# get the nullclines
nullcline_1 = solve(Eq(dn1dt, 0),n2)[0]
nullcline_2 = solve(Eq(dn2dt, 0),n2)[0]

# plot
n1s = np.linspace(0,100,100)
plt.plot(n1s, [nullcline_1.subs(n1,i) for i in n1s], label='$n_1$ nullcline')
plt.plot(n1s, [nullcline_2.subs(n1,i) for i in n1s], label='$n_2$ nullcline')

# # add predicted equilibrium
# n1eq = -((b2-d2-m21)*m1-m21*m2)/((b1-d1-m12)*(b2-d2-m21)-m21*m12)
# n2eq = -(-m12*m1+(b1-d1-m12)*m2)/((b1-d1-m12)*(b2-d2-m21)-m21*m12)
# plt.scatter(n1eq,n2eq, color='k', zorder=2, s=100, label='equilibrium')

plt.xlabel('number of birds on island 1, $n_1$')
plt.ylabel('number of birds on island 2, $n_2$')
plt.xlim(0,100)
plt.ylim(0,100)
plt.legend()
plt.show()
</pre>

<p><img alt="png" src="../lecture-07_files/lecture-07_7_0.png" /></p>
<p><span id='section5'></span></p>
<h2 id="5-summary">5. Summary</h2>
<hr>

<p>We can solve multivariate linear equations using matrix inversion, giving us a way to find equilibria when the matrix is invertible (ie, the determinant is nonzero). These equilibria are where the change in all variables is zero, i.e., where the nullclines for all variables intersect.</p>
<p>Practice questions from the textbook: P2.6-P2.11.</p>
<pre data-executable="true" data-language="python">

</pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "navigation.tabs"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>