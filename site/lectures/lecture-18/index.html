
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../images/favicon_non_transparent.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>Lecture 18 - Mathematical modelling in ecology and evolution (EEB314)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


  
  
    
      
      
      
    
  
  
  <style>:root{.md-tag{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M5.5%207A1.5%201.5%200%200%201%204%205.5%201.5%201.5%200%200%201%205.5%204%201.5%201.5%200%200%201%207%205.5%201.5%201.5%200%200%201%205.5%207m15.91%204.58-9-9C12.05%202.22%2011.55%202%2011%202H4c-1.11%200-2%20.89-2%202v7c0%20.55.22%201.05.59%201.41l8.99%209c.37.36.87.59%201.42.59s1.05-.23%201.41-.59l7-7c.37-.36.59-.86.59-1.41%200-.56-.23-1.06-.59-1.42%22/%3E%3C/svg%3E');}}</style>

    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lecture-18-evolutionary-invasion-analysis" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Mathematical modelling in ecology and evolution (EEB314)" class="md-header__button md-logo" aria-label="Mathematical modelling in ecology and evolution (EEB314)" data-md-component="logo">
      
  <img src="../../images/favicon_non_transparent.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Mathematical modelling in ecology and evolution (EEB314)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lecture 18
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="purple"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Overview

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../syllabus/instructors/" class="md-tabs__link">
          
  
  
  Syllabus

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../schedule/" class="md-tabs__link">
          
  
  
  Lectures

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../labs/schedule/" class="md-tabs__link">
          
  
  
  Labs

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../acknowledgements/" class="md-tabs__link">
        
  
  
    
  
  Acknowledgements

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Mathematical modelling in ecology and evolution (EEB314)" class="md-nav__button md-logo" aria-label="Mathematical modelling in ecology and evolution (EEB314)" data-md-component="logo">
      
  <img src="../../images/favicon_non_transparent.svg" alt="logo">

    </a>
    Mathematical modelling in ecology and evolution (EEB314)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Syllabus
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Syllabus
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/instructors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Instructors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/when_and_where/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    When and where
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/course_structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Course structure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/textbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Textbook
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/final_project/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Final Project
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/exams/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exams
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/general_info/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    General info
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Other resources
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Lectures
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Lectures
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schedule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schedule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-03/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-04/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 4
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Labs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/schedule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schedule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/tutorial-01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/tutorial-02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../acknowledgements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Acknowledgements
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lecture-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-invasion-fitness" class="md-nav__link">
    <span class="md-ellipsis">
      1. Invasion fitness
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-evolutionarily-singular-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      2. Evolutionarily singular strategies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-evolutionarily-stable-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      3. Evolutionarily stable strategies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-evolutionary-convergence" class="md-nav__link">
    <span class="md-ellipsis">
      4. Evolutionary convergence
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-pairwise-invasibility-plots" class="md-nav__link">
    <span class="md-ellipsis">
      5. Pairwise invasibility plots
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<script type="text/x-thebe-config">
  {
      requestKernel: true,
      mountActivateWidget: true,
      mountStatusWidget: true,
      binderOptions: {
      repo: "mmosmond/executable-cells",
      ref: "main",
      },
  }
</script>
<script src="https://unpkg.com/thebe@latest/lib/index.js"></script>
<p><link rel="stylesheet" href="https://unpkg.com/thebe@latest/lib/thebe.css"></p>
<h1 id="lecture-18-evolutionary-invasion-analysis">Lecture 18: Evolutionary invasion analysis</h1>
<hr style="margin-bottom: 0em;">
<center>
<div class="inrow">
    Run notes interactively?
    <div style="float: left;" class="thebe-activate"></div>
    <div class="thebe-status"></div>
</div>
</center>
<hr style="margin-top: 0em;">

<h2 id="lecture-overview">Lecture overview</h2>
<ol>
<li><a href="#section1">Invasion fitness</a></li>
<li><a href="#section2">Evolutionarily singular strategies</a></li>
<li><a href="#section3">Evolutionarily stable strategies</a></li>
<li><a href="#section4">Evolutionary convergence</a></li>
<li><a href="#section5">Pairwise invasibility plots</a></li>
</ol>
<p>In the models we've discussed so far we've taken the parameters to be fixed. In reality, many of these parameters can evolve. For example, in our model of exponential growth in discrete time, <span class="arithmatex">\(n(t+1)=n(t) R\)</span>, we took <span class="arithmatex">\(R\)</span> to be the same for all individuals for all time. But any mutation causing a larger <span class="arithmatex">\(R\)</span> would increase in frequency, causing the value of <span class="arithmatex">\(R\)</span> to increase over time. In this lecture we'll explore how to determine the direction of evolution and the stability of evolutionary endpoints for more complex models using a technique called <b>evolutionary invasion analysis</b> (also known as adaptive dynamics).</p>
<p>The idea:</p>
<ul>
<li>determine which parameter(s) of our model an evolving trait affects</li>
<li>take the population to be fixed for some "resident" trait value</li>
<li>determine the equilibria and stability of the system with only the resident trait</li>
<li>derive the growth rate of a new individual with a "mutant" trait value</li>
<li>ask when the mutant trait value will invade</li>
<li>look for potential evolutionary endpoints</li>
<li>determine the stability of those endpoints</li>
</ul>
<div class="admonition note">
<p class="admonition-title">The evolution of dispersal</p>
<p>To motivate evolutionary invasion analysis, let's consider the evolution of dispersal. </p>
<p>Imagine there are <span class="arithmatex">\(S\)</span> sites, with a most one individual reproducing at each. We census the population at the time of reproduction. A reproducing individual has a large number <span class="arithmatex">\(B\)</span> offspring and then dies. A fraction <span class="arithmatex">\(d\)</span> of those offspring disperse and a fraction <span class="arithmatex">\(1-c\)</span> of those survive. The survivors then equally divided among all sites. One individual in each site is then chosen at random to reproduce, which begins the life-cycle anew.</p>
<p>The question is, how should dispersal, <span class="arithmatex">\(d\)</span>, evolve? There is a cost, <span class="arithmatex">\(c\)</span>, which selects against dispersal but dispersal also allows offspring to avoid competiting with their kin, which could select for more dispersal. We'll use evolutionary invasion analysis to sort this out.</p>
</div>
<p><span id='section1'></span></p>
<h2 id="1-invasion-fitness">1. Invasion fitness</h2>
<hr>

<p>Let's think about this analysis very generally (in discrete time).</p>
<p>Let the number of individuals with the resident trait value be <span class="arithmatex">\(n\)</span> and the number of individuals with the mutant trait value <span class="arithmatex">\(n_m\)</span>. (And we'll assume asexual reproduction for simplicity, so that residents produce residents and mutant produce mutants.)
Let the potentially nonlinear dynamics of these two groups of individuals depend on their respective trait values, <span class="arithmatex">\(z\)</span> and <span class="arithmatex">\(z_m\)</span>,</p>
<div class="arithmatex">\[
\begin{aligned}
n(t+1) &amp;= n(t) R(n(t), n_m(t), z, z_m)\\
n_m(t+1) &amp;= n_m(t) R_m(n(t), n_m(t), z, z_m)
\end{aligned}
\]</div>
<p>The Jacobian of this system is</p>
<div class="arithmatex">\[
\begin{aligned}
\mathbf{J} &amp;= 
\begin{pmatrix}
\frac{\mathrm{d}n(t+1)}{\mathrm{d}n(t)} &amp; \frac{\mathrm{d}n(t+1)}{\mathrm{d}n_m(t)} \\
\frac{\mathrm{d}n_m(t+1)}{\mathrm{d}n(t)} &amp; \frac{\mathrm{d}n_m(t+1)}{\mathrm{d}n_m(t)} 
\end{pmatrix}
\end{aligned}
\]</div>
<p>Now consider some non-zero resident equilibrium, <span class="arithmatex">\(\hat{n}&gt;0\)</span>, without the mutant, <span class="arithmatex">\(\hat{n}_m=0\)</span>.
Assuming that the resident does not produce mutants, <span class="arithmatex">\(\frac{\mathrm{d}n_m(t+1)}{\mathrm{d}n(t)}\big|_{n_m=0}=0\)</span>,
the Jacobian evaluated at this equilibrium simplifies to</p>
<div class="arithmatex">\[
\begin{aligned}
\mathbf{J}\big|_{n_m=0,n=\hat{n}} &amp;= 
\begin{pmatrix}
\frac{\mathrm{d}n(t+1)}{\mathrm{d}n(t)} &amp; \frac{\mathrm{d}n(t+1)}{\mathrm{d}n_m(t)} \\
0 &amp; \frac{\mathrm{d}n_m(t+1)}{\mathrm{d}n_m(t)} 
\end{pmatrix}_{n_m=0,n=\hat{n}}
\end{aligned}
\]</div>
<p>We can immediately see that the two eigenvalues of this upper triangular matrix are</p>
<div class="arithmatex">\[
\begin{aligned}
\lambda_1 &amp;= \frac{\mathrm{d}n(t+1)}{\mathrm{d}n(t)}\bigg|_{n_m=0,n=\hat{n}}\\
\lambda_2 &amp;= \frac{\mathrm{d}n_m(t+1)}{\mathrm{d}n_m(t)}\bigg|_{n_m=0,n=\hat{n}}
\end{aligned}
\]</div>
<p>The first, <span class="arithmatex">\(\lambda_1\)</span>, determines whether the resident equilibrium, <span class="arithmatex">\(\hat{n}&gt;0\)</span>, is stable in the absence of mutants. We'll take <span class="arithmatex">\(0 &lt; \lambda_1 &lt; 1\)</span> as a given (we're only interested in stable resident equilibria, we can disregard the others).</p>
<p>The second, <span class="arithmatex">\(\lambda_2\)</span>, determines whether the resident equilibrium is stable in the presence of a small number of mutants. We call <span class="arithmatex">\(\lambda_2\)</span> the <strong>invasion fitness</strong>, <span class="arithmatex">\(\lambda(z_m,z)\)</span>. The mutant will invade whenever <span class="arithmatex">\(\lambda(z_m,z) &gt; 1\)</span>.</p>
<p>In some simple cases we might be able to use the invasion criterium, <span class="arithmatex">\(\lambda(z_m,z)&gt;1\)</span>, to determine what values of <span class="arithmatex">\(z_m\)</span> (relative to <span class="arithmatex">\(z\)</span>) can invade. In most cases, however, <span class="arithmatex">\(\lambda(z_m,z)\)</span> will be complex enough that this will not be possible, so we rely on a simple approximation.</p>
<div class="admonition note">
<p class="admonition-title">The evolution of dispersal</p>
<p>Let a fraction <span class="arithmatex">\(d\)</span> of the resident offspring disperse and a fraction <span class="arithmatex">\(d_m\)</span> of the mutant offspring disperse. And let there be <span class="arithmatex">\(n(t)\)</span> residents, <span class="arithmatex">\(n_m(t)\)</span> mutants, and <span class="arithmatex">\(S-n(t)-n_m(t)\geq0\)</span> empty sites. Then the probability a resident offspring replaces a resident is the number of resident offspring in a resident patch divided by the total number of offspring in that patch,</p>
<div class="arithmatex">\[
\begin{aligned}
p_{rr} &amp;= \frac{B(1-d) + (n(t)-1)Bd(1-c)/S}{B(1-d) + (n(t)-1)Bd(1-c)/S + n_m(t)Bd_m(1-c)/S}\\
&amp;= \frac{S(1-d) + (n(t)-1)d(1-c)}{S(1-d) + (n(t)-1)d(1-c) + n_m(t)d_m(1-c)}
\end{aligned}
\]</div>
<p>Here <span class="arithmatex">\(B(1-d)\)</span> is the number of non-dispersing offspring produced by the resident in that patch, <span class="arithmatex">\((n(t)-1)Bd(1-c)/S\)</span> is the number of resident offspring dispersing to the patch from elsewhere, and <span class="arithmatex">\(n_m(t)Bd_m(1-c)/S\)</span> is the number of mutant offspring dispersing to the patch. The probability that a mutant offspring replaces a mutant <span class="arithmatex">\(p_{mm}\)</span> is the same expression with <span class="arithmatex">\(d\)</span> and <span class="arithmatex">\(d_m\)</span> and <span class="arithmatex">\(n\)</span> and <span class="arithmatex">\(n_m\)</span> exchanged. The probability that a resident offspring wins an empty patch is </p>
<div class="arithmatex">\[
\begin{aligned}
p_{re} &amp;= \frac{n(t)Bd(1-c)}{n(t)Bd(1-c) + n_m(t)Bd_m(1-c)}\\
&amp;= \frac{n(t)d}{n(t)d + n_m(t)d_m}
\end{aligned}
\]</div>
<p>Then the number of resident and mutant individuals in the next generation are</p>
<div class="arithmatex">\[
\begin{aligned}
n(t+1) &amp;= n(t) p_{rr} + n_m(t) (1 - p_{mm}) + (S - n(t) - n_m(t)) p_{re}\\
n_m(t+1) &amp;= n(t) (1-p_{rr}) + n_m(t) p_{mm} + (S - n(t) - n_m(t)) (1-p_{re})
\end{aligned}
\]</div>
<p>Now consider an equilibrium with no mutants, <span class="arithmatex">\(\hat{n}_m=0\)</span>. Setting <span class="arithmatex">\(n(t+1) = n(t) = \hat{n}\)</span> gives <span class="arithmatex">\(\hat{n}=S\)</span>.</p>
<p>We determine the stability of this equilibrium with the Jacobian. From the general analysis above we know the two eigenvalues are</p>
<div class="arithmatex">\[
\begin{aligned}
\lambda_1 &amp;= \frac{\mathrm{d}n(t+1)}{\mathrm{d}n(t)}\bigg|_{n_m=0,n=S} = 0\\
\lambda_2 &amp;= \frac{\mathrm{d}n_m(t+1)}{\mathrm{d}n_m(t)}\bigg|_{n_m=0,n=S} = \frac{1-d_m}{1-d_m + d(1-c)} + \frac{d_m(1-c)}{1-d + d(1-c)}
\end{aligned}
\]</div>
<p>The first eigenvalue is less than 1 in absolute value, meaning the resident equilibrium is stable. The second eigenvalue is our invasion fitness</p>
<div class="arithmatex">\[
\lambda(d_m,d) = \frac{1-d_m}{1-d_m + d(1-c)} + \frac{d_m(1-c)}{1-d + d(1-c)}
\]</div>
<p>In this relatively simple example, we can determine exactly what mutant trait values can invade by looking at where</p>
<div class="arithmatex">\[
\lambda(d_m,d) - 1 = \frac{(1-c)(d_m-d)(1-cd-d_m)}{(1-cd)(1-d_m+d(1-c))}
\]</div>
<p>is positive. The sign of <span class="arithmatex">\(\lambda(d_m,d) - 1\)</span> is the sign of <span class="arithmatex">\((d_m-d)(1-cd-d_m)\)</span>. So the mutant will invade if both terms are positive <span class="arithmatex">\(d&lt;d_m&lt;1-cd\)</span> or both terms are negative <span class="arithmatex">\(1-cd&lt;d_m&lt;d\)</span>. In either case, the mutant will invade when it has a trait value between <span class="arithmatex">\(1-cd\)</span> and <span class="arithmatex">\(d\)</span>.</p>
</div>
<p><span id='section2'></span></p>
<h2 id="2-evolutionarily-singular-strategies">2. Evolutionarily singular strategies</h2>
<hr>

<p>When the mutant trait value is very close to the resident trait value, we can approximate invasion fitness with a Taylor series around <span class="arithmatex">\(z_m = z\)</span></p>
<div class="arithmatex">\[
\begin{aligned}
\lambda(z_m,z) &amp;\approx \lambda(z,z) + \frac{\partial \lambda}{\partial z_m}\bigg|_{z_m=z} (z_m-z)\\
&amp;= 1 + \frac{\partial \lambda}{\partial z_m}\bigg|_{z_m=z} (z_m-z)
\end{aligned}
\]</div>
<p>This allows us to determine which direction evolution will proceed from the current resident value:</p>
<ul>
<li>if <span class="arithmatex">\(\frac{\partial \lambda}{\partial z_m}\Big|_{z_m=z}&gt;0\)</span> then invasion when <span class="arithmatex">\(z_m&gt;z\)</span></li>
<li>if <span class="arithmatex">\(\frac{\partial \lambda}{\partial z_m}\Big|_{z_m=z}&lt;0\)</span> then invasion when <span class="arithmatex">\(z_m&lt;z\)</span></li>
</ul>
<p>The direction of evolution by small steps is given by <span class="arithmatex">\(\frac{\partial \lambda}{\partial z_m}\Big|_{z_m=z}\)</span>, which we call the <strong>selection gradient</strong>.</p>
<p>Potential evolutionary endpoints, also called <strong>evolutionarily singular strategies</strong>, are the resident trait values <span class="arithmatex">\(z=\hat{z}\)</span> where there is no directional selection</p>
<div class="arithmatex">\[
\frac{\partial \lambda}{\partial z_m}\bigg|_{z_m=\hat{z}, z=\hat{z}} = 0
\]</div>
<div class="admonition note">
<p class="admonition-title">The evolution of dispersal</p>
<p>The selection gradient is</p>
<div class="arithmatex">\[
\frac{\partial \lambda}{\partial d_m}\Big|_{d_m=d} = \frac{(1-d-dc))(1-c)}{(1-cd)^2}
\]</div>
<p>The sign of this is the sign of 1-d-dc, meaning the dispersal rate will increase whenever d&lt;1/(1+c) and decrease whenever 1/(1+c)&lt;d. Setting the selection gradient to zero and solving for the evolutionarily singular strategy gives <span class="arithmatex">\(\hat{d} = 1/(1+c)\)</span>.</p>
</div>
<p><span id='section3'></span></p>
<h2 id="3-evolutionarily-stable-strategies">3. Evolutionarily stable strategies</h2>
<hr>

<p>An evolutionarily singular strategy, <span class="arithmatex">\(\hat{z}\)</span>, will only be an <strong>evolutionarily stable strategy</strong> (ESS), <span class="arithmatex">\(z^*\)</span>, if it cannot be invaded.</p>
<p>Global evolutionary stability will be impossible to prove for most models and so we often focus on <em>local</em> stability, which requires that <span class="arithmatex">\(\lambda(z_m,z)|_{z=\hat{z}}\)</span> is concave at <span class="arithmatex">\(z_m=\hat{z}\)</span> (i.e., <span class="arithmatex">\(\hat{z}\)</span> is a local fitness maximum),</p>
<div class="arithmatex">\[
\frac{\partial^2 \lambda}{\partial z_m^2}\bigg|_{z_m=\hat{z}, z=\hat{z}} &lt; 0
\]</div>
<div class="admonition note">
<p class="admonition-title">The evolution of dispersal</p>
<p>The second derivative of invasion fitness with respect to the mutant trait value evalulated at the singular strategy is</p>
<div class="arithmatex">\[
\frac{\partial^2 \lambda}{\partial d_m^2}\Big|_{d_m=d=\hat{d}} = -2(1-c)(1+c)^2
\]</div>
<p>Because <span class="arithmatex">\(0&lt;c&lt;1\)</span> this is always negative, which means the singular strategy is always evolutionarily stable.</p>
</div>
<p><span id='section4'></span></p>
<h2 id="4-evolutionary-convergence">4. Evolutionary convergence</h2>
<hr>

<p>There is one more characteristic of evolutionarily singular strategies that we care about, and
that is whether evolution actually leads to that strategy or not. For evolution to move the trait value towards a singular strategy, <span class="arithmatex">\(\hat{z}\)</span>, we need evolution to increase the trait value when it is less than <span class="arithmatex">\(\hat{z}\)</span> and decrease the trait value when it is greater than <span class="arithmatex">\(\hat{z}\)</span>. In other words, we need the selection gradient <span class="arithmatex">\(\frac{\partial \lambda}{\partial z_m}\Big|_{z_m=z}\)</span> to decrease as we move through <span class="arithmatex">\(z=\hat{z}\)</span></p>
<div class="arithmatex">\[
\frac{\mathrm{d}}{\mathrm{d} z}\left( \frac{\partial \lambda}{\partial z_m}\Big|_{z_m=z} \right)_{z=\hat{z}} &lt; 0
\]</div>
<p>Singular strategies that satisfy this criteria are said to be <strong>convergence stable</strong>. </p>
<p>Interestingly, not all evolutionarily stable strategies are convergence stable and not all convergence stable singular strategies are evolutionarily stable! Evolutionarily stable strategies that are not convergence stable are called <strong>Garden of Eden strategies</strong>. Singular strategies that are convergence stable but not evolutionarily stable are called <strong>evolutionary branching points</strong>. The latter are of particular interest because the system evolves towards a state where multiple strategies can invade and coexist, leading to diversification.</p>
<div class="admonition note">
<p class="admonition-title">The evolution of dispersal</p>
<p>The derivative of the selection gradient evaluated at the singular strategy is</p>
<div class="arithmatex">\[
\frac{\mathrm{d}}{\mathrm{d} d}\left( \frac{\partial \lambda}{\partial d_m}\Big|_{d_m=d} \right)_{d=\hat{d}} = -(1-c)(1+c)^3
\]</div>
<p>Because <span class="arithmatex">\(0&lt;c&lt;1\)</span> this is always negative, which means the singular strategy is always convergence stable.</p>
</div>
<p><span id='section5'></span></p>
<h2 id="5-pairwise-invasibility-plots">5. Pairwise invasibility plots</h2>
<hr>

<p>A helpful way to visualize the two types of stability of an evolutionarily singular strategy is called a <strong>pairwise invasibility plot</strong> (PIP). In this plot we have the resident trait value <span class="arithmatex">\(z\)</span> on the x-axis, the mutant trait value <span class="arithmatex">\(z_m\)</span> on the y-axis, and we color in the regions where the mutant can invade, <span class="arithmatex">\(\lambda(z_m,z)&gt;1\)</span>.</p>
<p>The four types of evolutionarily singular strategies <span class="arithmatex">\(\hat{z}\)</span> are then represented by the following PIPs</p>
<pre data-executable="true" data-language="python">
import numpy as np
from matplotlib import pyplot as plt

# dummy invasion fitness
def inv(x, y, slope, z=1):
    if y < x:
      if y > slope * x:
        return z
    if y > x:
      if y < slope * x:
        return z
    return 1-z

# evaluate
def compute_pip(slope=-2,z=1,xmin=-2,xmax=2,steps=100):
    xs = np.linspace(xmin,xmax,steps)
    X,Y = np.meshgrid(xs,xs) # X and Y values
    # store the invasion success in a matrix
    PIP = []
    for y in xs:
      row = []
      for x in xs:
        row.append(inv(x,y,slope,z))
      PIP.append(row)
    return X,Y,PIP

# plot
def plotfun(X,Y,Z,slope=1,ax=None):
    if ax==None:
      fig, ax=plt.subplots(1,1,figsize=(5,5))
    ax.contourf(X,Y,Z, colors=['white','black','blue','black'])
    ax.plot(X[0],X[0],'k',lw=5)
    ax.plot(X[0],X[0]*slope,'k',lw=5)
    ax.set_xlim(min(X[0]),max(X[0]))
    ax.set_ylim(min(X[0]),max(X[0]))
    ax.set_xlabel('resident trait value $z$')
    ax.set_ylabel('mutant trait value $z_m$')
    ax.set_xticks([])
    ax.set_yticks([])

fig, axs = plt.subplots(2,2,figsize=(10,10))
X,Y,Z = compute_pip(slope=-4,z=1)
plotfun(X,Y,Z,slope=-4,ax=axs[0][0])
axs[0][0].set_title('evolutionarily stable',fontsize=14)
axs[0][1].text(2.1,0,'convergence stable',fontsize=14,rotation=270,verticalalignment='center')
X,Y,Z = compute_pip(slope=4,z=0)
plotfun(X,Y,Z,slope=4,ax=axs[0][1])
axs[0][1].set_title('evolutionarily unstable',fontsize=14)
X,Y,Z = compute_pip(slope=4,z=1)
plotfun(X,Y,Z,slope=4,ax=axs[1][0])
axs[1][1].text(2.1,0,'convergence unstable',fontsize=14,rotation=270,verticalalignment='center')
X,Y,Z = compute_pip(slope=-4,z=0)
plotfun(X,Y,Z,slope=-4,ax=axs[1][1])
</pre>

<p><img alt="png" src="../lecture-18_files/lecture-18_17_0.png" /></p>
<p>We can read a PIP by choosing a resident trait value (a point on the x-axis) and looking to see what mutant trait values can invade it (blue regions in that vertical slice). Choose one of the possible invading trait values and set this to be the new resident trait value. Continue indefinitely. </p>
<p>When we assume mutants have trait values close to the resident, we restrict ourselves to moving along the 1:1 line. Then, we move to the right when there is blue directly above the 1:1 line but not below and we move to the left when there is blue directly below the 1:1 line but not above. Where there is blue directly above and below the 1:1 we are at a singular strategy that is a fitness minimum (it can be invaded in both directions). Where there is white directly above and below the 1:1 we are at a singular strategy that is a fitness maximum (it can't be invaded in either direction).</p>
<p>Try reading each of the plots above. Prove to yourself that the top left has a convergence stable evolutionarily stable strategy, the top right has a branching point, the bottom left has a has a Garden of Eden, and the bottom right has an invasible repellor (a fitness minimum that is not convergence stable).</p>
<div class="admonition note">
<p class="admonition-title">The evolution of dispersal</p>
<p>In our model of the evolution of dispersal, the singular strategy is always evolutionarily and convgence stable, and the PIP is below.</p>
</div>
<pre data-executable="true" data-language="python">
import numpy as np
from matplotlib import pyplot as plt

# invasion fitness
def inv_fun(dm,d,c):
    invasionfitness = (1-dm)/(1-dm + d*(1-c)) + (dm*(1-c))/(1-d + d*(1-c))
    if invasionfitness>1:
        return 1 # return 1 if mutant invades
    return 0 # return 0 if mutant does not invade

# evaluate
def compute_pip(c=0.5,dmin=0.01,dmax=0.99,steps=100):
    ds = np.linspace(dmin,dmax,steps)
    X,Y = np.meshgrid(ds,ds) # X and Y values
    # store the invasion success in a matrix
    PIP = []
    for dm in ds:
      row = []
      for d in ds:
        row.append(inv_fun(dm,d,c))
      PIP.append(row)
    return X,Y,PIP

# plot
def plotfun(X,Y,Z):
    fig, ax = plt.subplots(1,1,figsize=(5,5))
    ax.set_xlabel('$d$')
    ax.set_ylabel('$d_m$')
    ax.contourf(X,Y,Z, colors=['white','black','blue','black'])
    ax.plot(X[0],X[0],'k',lw=5)

X,Y,Z=compute_pip()
plotfun(X,Y,Z)
</pre>

<p><img alt="png" src="../lecture-18_files/lecture-18_20_0.png" /></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "navigation.tabs"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>