
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../lecture-03/">
      
      
        <link rel="next" href="../lecture-05/">
      
      
      <link rel="icon" href="../../images/favicon_non_transparent.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Lecture 4 - Mathematical modelling in ecology and evolution (EEB314)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


  
  
    
      
      
      
    
  
  
  <style>:root{.md-tag{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M5.5%207A1.5%201.5%200%200%201%204%205.5%201.5%201.5%200%200%201%205.5%204%201.5%201.5%200%200%201%207%205.5%201.5%201.5%200%200%201%205.5%207m15.91%204.58-9-9C12.05%202.22%2011.55%202%2011%202H4c-1.11%200-2%20.89-2%202v7c0%20.55.22%201.05.59%201.41l8.99%209c.37.36.87.59%201.42.59s1.05-.23%201.41-.59l7-7c.37-.36.59-.86.59-1.41%200-.56-.23-1.06-.59-1.42%22/%3E%3C/svg%3E');}}</style>

    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lecture-4-stability-univariate" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Mathematical modelling in ecology and evolution (EEB314)" class="md-header__button md-logo" aria-label="Mathematical modelling in ecology and evolution (EEB314)" data-md-component="logo">
      
  <img src="../../images/favicon_non_transparent.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Mathematical modelling in ecology and evolution (EEB314)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lecture 4
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="purple"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Overview

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../syllabus/course_structure/" class="md-tabs__link">
          
  
  
  Syllabus

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../schedule/" class="md-tabs__link">
          
  
  
  Lectures

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../labs/schedule/" class="md-tabs__link">
          
  
  
  Labs

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../acknowledgements/" class="md-tabs__link">
        
  
  
    
  
  Acknowledgements

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Mathematical modelling in ecology and evolution (EEB314)" class="md-nav__button md-logo" aria-label="Mathematical modelling in ecology and evolution (EEB314)" data-md-component="logo">
      
  <img src="../../images/favicon_non_transparent.svg" alt="logo">

    </a>
    Mathematical modelling in ecology and evolution (EEB314)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Syllabus
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Syllabus
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/course_structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Course structure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/instructors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Instructors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/when_and_where/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    When and where
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/textbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Textbook
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/final_project/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Final Project
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/previous_tests/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Previous Tests
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/general_info/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    General info
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Other resources
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Lectures
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Lectures
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schedule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schedule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-03/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Lecture 4
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Lecture 4
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lecture-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-stability" class="md-nav__link">
    <span class="md-ellipsis">
      1. Stability
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Stability">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formal-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Formal analysis
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-example-diploid-selection" class="md-nav__link">
    <span class="md-ellipsis">
      2. Example: diploid selection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-summary" class="md-nav__link">
    <span class="md-ellipsis">
      3. Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-05/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 5
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-06/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 6
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-07/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 7
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-08/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 8
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-09/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 9
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 10
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-11/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 11
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Labs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/schedule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schedule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/tutorial-01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/tutorial-02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/tutorial-03/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/tutorial-04/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 4
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/tutorial-05/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 5
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/tutorial-06/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 6
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../acknowledgements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Acknowledgements
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lecture-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-stability" class="md-nav__link">
    <span class="md-ellipsis">
      1. Stability
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Stability">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formal-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Formal analysis
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-example-diploid-selection" class="md-nav__link">
    <span class="md-ellipsis">
      2. Example: diploid selection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-summary" class="md-nav__link">
    <span class="md-ellipsis">
      3. Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<script type="text/x-thebe-config">
  {
      requestKernel: true,
      mountActivateWidget: true,
      mountStatusWidget: true,
      binderOptions: {
      repo: "mmosmond/executable-cells",
      ref: "main",
      },
  }
</script>
<script src="https://unpkg.com/thebe@latest/lib/index.js"></script>
<p><link rel="stylesheet" href="https://unpkg.com/thebe@latest/lib/thebe.css"></p>
<h1 id="lecture-4-stability-univariate">Lecture 4: Stability (univariate)</h1>
<hr style="margin-bottom: 0em;">
<center>
<div class="inrow">
    Run notes interactively?
    <div style="float: left;" class="thebe-activate"></div>
    <div class="thebe-status"></div>
</div>
</center>
<hr style="margin-top: 0em;">

<h2 id="lecture-overview">Lecture overview</h2>
<ol>
<li><a href="#section1">Stability</a></li>
<li><a href="#section2">Example: diploid selection</a></li>
<li><a href="#section3">Summary</a></li>
</ol>
<p><span id='section1'></span></p>
<h2 id="1-stability">1. Stability</h2>
<hr>

<p>When a variable (<span class="arithmatex">\(x\)</span>) is exactly at an equilibrium (<span class="arithmatex">\(\hat x\)</span>) its value will never change. But what happens when we are not exactly at, but just near an equilibrium?</p>
<p>Starting near an equilibrium, if the system moves towards the equilibrium over time the equilibrium is said to be <strong>locally stable</strong>. In contrast, if the system moves away from the equilibrium over time the equilibrium is said to be <strong>unstable</strong>.</p>
<h3 id="formal-analysis">Formal analysis</h3>
<p>To determine local stability mathematically, we focus on a small perturbation (<span class="arithmatex">\(\epsilon\)</span>) away from an equilibrium and determine whether this perturbation will grow or shrink.</p>
<p>Let's do this in discrete time with recursion <span class="arithmatex">\(x(t+1) = f(x(t))\)</span> where <span class="arithmatex">\(f(x(t))\)</span> is the function that defines the recursion, e.g., <span class="arithmatex">\(f(x(t))=Rx(t)\)</span> for exponential population growth.</p>
<p>If at time <span class="arithmatex">\(t\)</span> the variable is a small distance from equilibrium, <span class="arithmatex">\(x(t) = \hat{x} + \epsilon(t)\)</span>, 
then at time <span class="arithmatex">\(t+1\)</span> the variable will be at <span class="arithmatex">\(x(t+1) = f(\hat{x} + \epsilon(t))\)</span>.</p>
<p>To work with this arbitrary function, <span class="arithmatex">\(f\)</span>, let's introduce a pretty remarkable mathematical fact, the <strong>Taylor Series</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Taylor Series</p>
<p>Any function <span class="arithmatex">\(f(x)\)</span> can be written as an infinite series of derivatives evaluated at <span class="arithmatex">\(x=a\)</span></p>
<div class="arithmatex">\[
f(x) = \sum_{k = 0}^{\infty}\frac{f^{(k)}(a)}{k!}(x-a)^k
\]</div>
<p>where <span class="arithmatex">\(f^{(k)}(a)\)</span> is the <span class="arithmatex">\(k^{\mathrm{th}}\)</span> derivative of the function with respect to <span class="arithmatex">\(x\)</span>, evaluated at point <span class="arithmatex">\(a\)</span>. (See section P1.3 in the textbook for more information).</p>
</div>
<p>Taking the Taylor Series of <span class="arithmatex">\(f(\hat{x} + \epsilon(t))\)</span> around <span class="arithmatex">\(\epsilon(t)=0\)</span> </p>
<div class="arithmatex">\[
\begin{aligned}
x(t+1) &amp;= f(\hat{x} + \epsilon(t))\\
&amp;= f(\hat{x}) + f^{(1)}(\hat{x})(\hat{x} + \epsilon(t) - \hat{x}) + \frac{f^{(2)}(\hat{x})}{2}(\hat{x} + \epsilon(t) - \hat{x})^2 + \cdots\\
&amp;= f(\hat{x}) + f^{(1)}(\hat{x})\epsilon(t) + \frac{f^{(2)}(\hat{x})}{2}\epsilon(t)^2 + \cdots\\
\end{aligned}
\]</div>
<p>Now, to work with this infinite series we will make an assumption, that we are very the equilibrium, meaning the deviation is small, <span class="arithmatex">\(\epsilon&lt;&lt;1\)</span>. This means that <span class="arithmatex">\(\epsilon^2\)</span> is even smaller, and <span class="arithmatex">\(\epsilon^3\)</span> even smaller than that, and so on. By considering small <span class="arithmatex">\(\epsilon\)</span> we can therefore cut-off our infinite series by ignoring any term with <span class="arithmatex">\(\epsilon\)</span> to a power greater than 1. This is called a "first order" Taylor series approximation of <span class="arithmatex">\(f\)</span> around <span class="arithmatex">\(\epsilon=0\)</span>. This assumption is what limits us to determining only <em>local</em> stability. Global stability would require us to consider large deviations from the equilibrium as well, which is not possible for even mildly complicated functions, <span class="arithmatex">\(f\)</span>.</p>
<p>Keeping the first order term only, we can solve for the new deviation from the equilibrium, <span class="arithmatex">\(\epsilon(t+1) = x(t+1) - \hat x\)</span>,</p>
<div class="arithmatex">\[
\begin{aligned}
x(t+1) &amp;= f(\hat{x}) + f^{(1)}(\hat{x})\epsilon(t)\\
&amp;= \hat{x} + f^{(1)}(\hat{x})\epsilon(t)\\
x(t+1) - \hat x &amp;= f^{(1)}(\hat{x})\epsilon(t)\\
\epsilon(t+1) &amp;= f^{(1)}(\hat{x})\epsilon(t)
\end{aligned}
\]</div>
<p>So the recursion for the deviation from equilibrium, <span class="arithmatex">\(\epsilon\)</span>, is the recursion for exponential population growth with reproductive factor <span class="arithmatex">\(\lambda = f^{(1)}(\hat{x})\)</span>. </p>
<p>Based on our knowledge of discrete-time exponential growth, we therefore know that the deviation from equilibrium will:</p>
<ul>
<li>
<p>move from one side of the equilibrium to the other (i.e., oscillate) if <span class="arithmatex">\(\lambda\)</span> is negative</p>
<ul>
<li>grow if <span class="arithmatex">\(\lambda &lt; -1\)</span> <span class="arithmatex">\(\implies\hat{x}\)</span> unstable</li>
<li>shrink if <span class="arithmatex">\(-1 &lt; \lambda &lt; 0\)</span> <span class="arithmatex">\(\implies\hat{x}\)</span> locally stable</li>
</ul>
</li>
<li>
<p>stay on the same side of the equilibrium (i.e., not oscillate) if <span class="arithmatex">\(\lambda\)</span> is positive</p>
<ul>
<li>shrink if <span class="arithmatex">\(0&lt;\lambda&lt;1\)</span> <span class="arithmatex">\(\implies\hat{x}\)</span> locally stable</li>
<li>grow if <span class="arithmatex">\(1&lt;\lambda\)</span> <span class="arithmatex">\(\implies\hat{x}\)</span> unstable</li>
</ul>
</li>
</ul>
<p>Local stability in discrete time therefore requires the slope of the recursion to be between -1 and 1 at the equilibrium, </p>
<div class="arithmatex">\[
-1 &lt; f^{(1)}(\hat{x})=\left.\frac{\mathrm{d}x(t+1)}{\mathrm{d}x(t)}\right|_{x(t)=\hat x} &lt; 1.
\]</div>
<p>A very similar analysis in continuous time, where the variable changes accorging to differential equation <span class="arithmatex">\(df(x)/dt=f(x)\)</span>, shows that an equilibrium <span class="arithmatex">\(\hat x\)</span> is stable if the slope of the differential equation is negative at the equilibrium, </p>
<div class="arithmatex">\[
f^{(1)}(\hat{x}) = \left.\frac{\mathrm{d}}{\mathrm{d}x}\left(\frac{\mathrm{d}x}{\mathrm{d}t}\right)\right|_{x=\hat{x}} &lt; 0.
\]</div>
<p>In continuous time there are no oscilations in one dimension because you cannot go past an equilibrium without hitting it.</p>
<p>Notice that these derivatives are the slopes of the curves at the equilibria in the plots of the variables as functions of themselves: <span class="arithmatex">\(x(t+1)\)</span> and <span class="arithmatex">\(dx/dt\)</span> as functions of <span class="arithmatex">\(x(t)\)</span>.</p>
<p><span id='section2'></span></p>
<h2 id="2-example-diploid-selection">2. Example: diploid selection</h2>
<hr>

<p>To try this out on a biological example, let's return to diploid selection, where the frequency of the <span class="arithmatex">\(A\)</span> allele in the next generation is</p>
<div class="arithmatex">\[
p(t+1) = \frac{W_{AA}p(t)^2 + W_{Aa}p(t)(1-p(t))}{\bar{W}(p(t))},
\]</div>
<p>where <span class="arithmatex">\(\bar{W}(p(t)) = W_{AA}p(t)^2 + 2W_{Aa}p(t) (1-p(t)) + W_{aa}(1-p(t))^2\)</span> is the mean fitness in the population, which depends on <span class="arithmatex">\(p(t)\)</span>.</p>
<p>In the previous lecture we found there were three equilibria:</p>
<ul>
<li><span class="arithmatex">\(\hat p = 0\)</span></li>
<li><span class="arithmatex">\(\hat p = \frac{W_{Aa} - W_{aa}}{2W_{Aa} - W_{AA} - W_{aa}}\)</span></li>
<li><span class="arithmatex">\(\hat p = 1\)</span></li>
</ul>
<p>Now our job is to find when each of these is locally stable, which requires the slope of the recursion at that point be between -1 and 1, </p>
<div class="arithmatex">\[
-1 &lt; \left.\frac{\mathrm{d}p(t+1)}{\mathrm{d}p(t)}\right|_{p(t)=\hat p} &lt; 1.
\]</div>
<p>To see this visually first, we can draw cobweb plots for particular parameter values. Last lecture we learned that the internal equilibrium is only valid if the hterozygote is most fit <span class="arithmatex">\(W_{AA} &lt; W_{Aa} &gt; W_{aa}\)</span> (overdominance) or least fit <span class="arithmatex">\(W_{AA} &gt; W_{Aa} &lt; W_{aa}\)</span> (underdominance), so let's look at parameter values that fall within those two cases.</p>
<pre data-executable="true" data-language="python">
import numpy as np
import matplotlib.pyplot as plt

# recursion
def f(p, WAA, WAa, Waa):
    return (WAA * p**2 + WAa * p * (1 - p)) / (WAA * p**2 + WAa * 2 * p * (1 - p) + Waa * (1 - p)**2)

# generator for cobweb
def pt(p0, WAA, WAa, Waa, max=np.inf):
    t, pnow, pnext = 0, p0, 0 #initial conditions
    while t < max:
        yield pnow, pnext #current value of p(t) and p(t+1), as both are needed for cob-webbing
        pnext = (WAA * pnow**2 + WAa * pnow * (1 - pnow)) / (WAA * pnow**2 + WAa * 2 * pnow * (1 - pnow) + Waa * (1 - pnow)**2) #update p(t+1)
        yield pnow, pnext #current value of p(t) and p(t+1)
        pnow = pnext #update p(t)
        t += 1 #update t
# plot
fig, axs = plt.subplots(1,2, figsize=(10,5))

WAA, Waa = 1, 1
WAas = [2,0.5]
p0= 0.25

for i,WAa in enumerate(WAas): 

    # evaluate
    xs = np.linspace(0,1,100) #allele freqs at time t
    ys = [f(x, WAA, WAa, Waa) for x in xs] #allele freqs at time t+1
    pts = pt(p0, WAA, WAa, Waa, max=10) # initialize generator
    ps = np.array([[x,y] for x,y in pts]) # compute x,y pairs by iterating through generator

    # recursion
    axs[i].plot(xs, ys, color='black') #p(t+1) as function of p(t)
    axs[i].plot(xs, xs, color='black', linestyle='--') #1:1 line for reference

    # cobwebs
    axs[i].plot(ps[:,0], ps[:,1])

    axs[i].set_xlim(0,1)
    axs[i].set_ylim(0,1)
    axs[i].set_xlabel("allele frequency at $t$, $p(t)$")
    axs[i].set_ylabel("allele frequency at $t+1$, $p(t+1)$")
    axs[i].set_title(r'$W_{AA}=%s, W_{Aa}=%s, W_{aa}=%s$' %(WAA,WAa,Waa))

plt.show()
</pre>

<p><img alt="png" src="../lecture-04_files/lecture-04_3_0.png" /></p>
<p>The equilibria are where the solid line intersects the dashed line. Focusing on the internal equilibrium for illustration, we see that the slope at the intersection is less than one (which is the slope of the dashed line) in the left plot and greater than one in the right plot. Correspondingly, we see that the internal equilibrium is stable in the left plot and unstable in the right plot. To more precisely determine the boundary between stability and instability we need to perform our local stability analysis.</p>
<p>We start the stability analysis by taking the derivative of <span class="arithmatex">\(p(t+1)\)</span> as a function of <span class="arithmatex">\(p(t)\)</span>, using the quotient rule</p>
<div class="arithmatex">\[
\begin{aligned}
&amp;\frac{\mathrm{d}}{\mathrm{d}p(t)}\left(\frac{W_{AA}p(t)^2 + W_{Aa}p(t)(1-p(t))}{\bar{W}(p(t))}\right)\\
&amp;=\frac{(2W_{AA}p(t) + W_{Aa}(1-2p(t)))\bar{W}(p(t))}{\bar{W}(p(t))^2}\\
&amp;-\frac{(W_{AA}p(t)^2+W_{Aa}p(t)(1-p(t)))(2W_{AA}p(t)+2W_{Aa}(1-2p(t))-2(1-p(t))W_{aa})}{\bar{W}(p(t))^2}.
\end{aligned}
\]</div>
<p>This is a complicated expression! Fortunately stability is determined by the value of this derivative evaluated at <span class="arithmatex">\(p(t)=\hat{p}\)</span>, which can be considerably simpler. </p>
<p>Let's start with <span class="arithmatex">\(\hat{p} = 0\)</span>. In this case we have </p>
<div class="arithmatex">\[
\begin{aligned}
\left.\frac{\mathrm{d}p(t+1)}{\mathrm{d}p(t)}\right|_{p(t)=0} &amp;= \frac{W_{Aa}\bar{W}(0)}{\bar{W}(0)^2}\\
&amp;= \frac{W_{Aa}}{\bar{W}(0)}\\
&amp;= \frac{W_{Aa}}{W_{aa}}.
\end{aligned}
\]</div>
<p>And similarly for <span class="arithmatex">\(\hat p = 1\)</span>, we have</p>
<div class="arithmatex">\[
\begin{aligned}
\left.\frac{\mathrm{d}p(t+1)}{\mathrm{d}p(t)}\right|_{p(t)=1} &amp;= \frac{(2W_{AA} - W_{Aa})\bar{W}(1) - W_{AA}(2W_{AA}-2W_{Aa})}{\bar{W}(1)^2}\\
&amp;= \frac{(2W_{AA} - W_{Aa})W_{AA} - W_{AA}(2W_{AA}-2W_{Aa})}{W_{AA}^2}\\
&amp;= \frac{2W_{AA} - W_{Aa} - 2W_{AA}+2W_{Aa}}{W_{AA}}\\
&amp;= \frac{W_{Aa}}{W_{AA}}.
\end{aligned}
\]</div>
<p>Since fitness is always greater than or equal to zero, <span class="arithmatex">\(W_i\geq0\)</span>, so are these derivatives. We therefore know that they are greater than -1 and what is left for stability is to determine when they are less than 1. This will occur whenever the numerator is less than the denominator, meaning that <span class="arithmatex">\(\hat p = 0\)</span> is stable when <span class="arithmatex">\(W_{Aa} &lt; W_{aa}\)</span> and <span class="arithmatex">\(\hat p = 1\)</span> is stable when <span class="arithmatex">\(W_{Aa} &lt; W_{AA}\)</span>. This makes good sense. Take <span class="arithmatex">\(\hat p = 0\)</span> for example. This means that the <span class="arithmatex">\(a\)</span> allele is fixed. When we introduce just a few <span class="arithmatex">\(A\)</span> alleles, <span class="arithmatex">\(p(t) &lt;&lt; 1\)</span>, they will occur in heterozygotes because it is very unlikely that they pair with each other under under random mating, <span class="arithmatex">\(p(t)^2\approx0\)</span>. So the spread of the <span class="arithmatex">\(A\)</span> allele and an increase in <span class="arithmatex">\(p\)</span> is determined by the spread of the heterozygote, which is prevented by selection when <span class="arithmatex">\(W_{Aa} &lt; W_{aa}\)</span>. The same reasoning holds for <span class="arithmatex">\(\hat p = 1\)</span>. Check that these stability criteria are consistent with the cobweb plots above.</p>
<p>Now for the internal equilibrium. It's stability is determined the same way, but this time we skip the algebra for the sake of time</p>
<div class="arithmatex">\[
\begin{aligned}
\left.\frac{\mathrm{d}p(t+1)}{\mathrm{d}p(t)}\right|_{p(t)=\frac{W_{Aa} - W_{aa}}{2W_{Aa} - W_{AA} - W_{aa}}} &amp;= \frac{W_{AA}W_{Aa}-2W_{AA}W_{aa}+W_{Aa}W_{aa}}{W_{Aa}^2-W_{AA}W_{aa}}.
\end{aligned}
\]</div>
<p>Not bad. Now let's consider the two scenarios under which this internal equilibrium is biologically valid.</p>
<p>In case A we have overdominance, <span class="arithmatex">\(W_{AA} &lt; W_{Aa} &gt; W_{aa}\)</span>. This means that both numerator and denominator are positive. Since the derivative is positive it is always greater than -1 and all that is left for stability is for the derivative to be less than 1, ie the numerator is less than the denominator</p>
<div class="arithmatex">\[
\begin{aligned}
W_{AA}W_{Aa}-2W_{AA}W_{aa}+W_{Aa}W_{aa} &amp;&lt; W_{Aa}^2-W_{AA}W_{aa}\\
W_{AA}W_{Aa}-W_{AA}W_{aa}+W_{Aa}W_{aa} - W_{Aa}^2 &amp;&lt; 0,
\end{aligned}
\]</div>
<p>which is always true with <span class="arithmatex">\(W_{AA} &lt; W_{Aa} &gt; W_{aa}\)</span>, implying stability with overdominance.</p>
<p>In case B we have underdominance, <span class="arithmatex">\(W_{AA} &gt; W_{Aa} &lt; W_{aa}\)</span>. This means that both numerator and denominator are negative. Since the derivative is positive it is always greater than -1 and all that is left for stability is for the derivative to be less than 1, which is the condition we just derived in the equation above. In case B however, the condition never holds, implying instability with underdominance.</p>
<p>In sum, the internal equilibrium is biologically valid and locally stable only if there is overdominance, <span class="arithmatex">\(W_{AA} &lt; W_{Aa} &gt; W_{aa}\)</span>. This makes good intuitive sense since there are more heterozygotes at a more intermediate frequency (<span class="arithmatex">\(2p(1-p)\)</span> has a max at <span class="arithmatex">\(p=1/2\)</span>). It also implies that the internal equilibrium is stable when the boundary equilibria are unstable, and vice versa. When the internal equilibrium is unstable it therefore acts as a replellor between two locally stable equilibria, pushing allele frequency towards the boundary that is on the same side of the repellor. Check that this all makes sense with the plots above.</p>
<p><span id='section3'></span></p>
<h2 id="3-summary">3. Summary</h2>
<hr>

<p>Local stability analysis for discrete- and continuous-time models with one variable:</p>
<ol>
<li>take the derivative of the recursion or differential equation with respect to the variable, <span class="arithmatex">\(f^{(1)}(x)\)</span></li>
<li>plug in the equilibrium value of the variable, <span class="arithmatex">\(\lambda=f^{(1)}(\hat x)\)</span></li>
<li>local stability requires <span class="arithmatex">\(-1 &lt; \lambda &lt; 1\)</span> in discrete time and <span class="arithmatex">\(\lambda &lt; 0\)</span> in continuous time</li>
</ol>
<p>Practice questions from the textbook: 5.4, 5.6-5.13</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "navigation.tabs"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>