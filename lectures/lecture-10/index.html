
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../lecture-09/">
      
      
        <link rel="next" href="../lecture-11/">
      
      
      <link rel="icon" href="../../images/favicon_non_transparent.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Lecture 10 - Mathematical modelling in ecology and evolution (EEB314)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


  
  
    
      
      
      
    
  
  
  <style>:root{.md-tag{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M5.5%207A1.5%201.5%200%200%201%204%205.5%201.5%201.5%200%200%201%205.5%204%201.5%201.5%200%200%201%207%205.5%201.5%201.5%200%200%201%205.5%207m15.91%204.58-9-9C12.05%202.22%2011.55%202%2011%202H4c-1.11%200-2%20.89-2%202v7c0%20.55.22%201.05.59%201.41l8.99%209c.37.36.87.59%201.42.59s1.05-.23%201.41-.59l7-7c.37-.36.59-.86.59-1.41%200-.56-.23-1.06-.59-1.42%22/%3E%3C/svg%3E');}}</style>

    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lecture-10-demography" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Mathematical modelling in ecology and evolution (EEB314)" class="md-header__button md-logo" aria-label="Mathematical modelling in ecology and evolution (EEB314)" data-md-component="logo">
      
  <img src="../../images/favicon_non_transparent.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Mathematical modelling in ecology and evolution (EEB314)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lecture 10
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="purple"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Overview

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../syllabus/course_structure/" class="md-tabs__link">
          
  
  
  Syllabus

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../schedule/" class="md-tabs__link">
          
  
  
  Lectures

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../labs/schedule/" class="md-tabs__link">
          
  
  
  Labs

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../acknowledgements/" class="md-tabs__link">
        
  
  
    
  
  Acknowledgements

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Mathematical modelling in ecology and evolution (EEB314)" class="md-nav__button md-logo" aria-label="Mathematical modelling in ecology and evolution (EEB314)" data-md-component="logo">
      
  <img src="../../images/favicon_non_transparent.svg" alt="logo">

    </a>
    Mathematical modelling in ecology and evolution (EEB314)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Syllabus
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Syllabus
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/course_structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Course structure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/instructors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Instructors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/when_and_where/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    When and where
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/textbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Textbook
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/final_project/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Final Project
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/previous_tests/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Previous Tests
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/general_info/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    General info
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Other resources
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Lectures
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Lectures
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schedule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schedule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-03/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-04/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 4
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-05/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 5
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-06/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 6
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-07/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 7
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-08/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 8
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-09/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 9
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Lecture 10
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Lecture 10
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lecture-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-demography" class="md-nav__link">
    <span class="md-ellipsis">
      1. Demography
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-stage-structure" class="md-nav__link">
    <span class="md-ellipsis">
      2. Stage-structure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Stage-structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-north-atlantic-right-whale" class="md-nav__link">
    <span class="md-ellipsis">
      Example: North Atlantic right whale
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-age-structure" class="md-nav__link">
    <span class="md-ellipsis">
      3. Age-structure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Age-structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-stickleback" class="md-nav__link">
    <span class="md-ellipsis">
      Example: stickleback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-summary" class="md-nav__link">
    <span class="md-ellipsis">
      4. Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-11/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 11
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-12/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 12
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Labs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/schedule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schedule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/tutorial-01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/tutorial-02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/tutorial-03/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/tutorial-04/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 4
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/tutorial-05/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 5
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/tutorial-06/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 6
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/tutorial-07/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 7
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../acknowledgements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Acknowledgements
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lecture-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-demography" class="md-nav__link">
    <span class="md-ellipsis">
      1. Demography
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-stage-structure" class="md-nav__link">
    <span class="md-ellipsis">
      2. Stage-structure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Stage-structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-north-atlantic-right-whale" class="md-nav__link">
    <span class="md-ellipsis">
      Example: North Atlantic right whale
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-age-structure" class="md-nav__link">
    <span class="md-ellipsis">
      3. Age-structure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Age-structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-stickleback" class="md-nav__link">
    <span class="md-ellipsis">
      Example: stickleback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-summary" class="md-nav__link">
    <span class="md-ellipsis">
      4. Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<script type="text/x-thebe-config">
  {
      requestKernel: true,
      mountActivateWidget: true,
      mountStatusWidget: true,
      binderOptions: {
      repo: "mmosmond/executable-cells",
      ref: "main",
      },
  }
</script>
<script src="https://unpkg.com/thebe@latest/lib/index.js"></script>
<p><link rel="stylesheet" href="https://unpkg.com/thebe@latest/lib/thebe.css"></p>
<h1 id="lecture-10-demography">Lecture 10: Demography</h1>
<hr style="margin-bottom: 0em;">
<center>
<div class="inrow">
    Run notes interactively?
    <div style="float: left;" class="thebe-activate"></div>
    <div class="thebe-status"></div>
</div>
</center>
<hr style="margin-top: 0em;">

<h2 id="lecture-overview">Lecture overview</h2>
<ol>
<li><a href="#section1">Demography</a></li>
<li><a href="#section2">Stage-structure</a></li>
<li><a href="#section3">Age-structure</a></li>
<li><a href="#section4">Summary</a></li>
</ol>
<p><span id='section1'></span></p>
<h2 id="1-demography">1. Demography</h2>
<hr>

<p>We're now going to use what we've learned about linear multivariate models to describe the dynamics of a population that is composed of different types of individuals. This area of research is called <strong>demography</strong>. </p>
<p>We'll just consider discrete-time linear models here and consider closed populations, so that the number of individuals of each type in the next timestep is</p>
<div class="arithmatex">\[
\vec{n}(t+1) = \mathbf{M}\vec{n}(t),
\]</div>
<p>where <span class="arithmatex">\(\mathbf{M}\)</span> describes the transitions from one type to another.</p>
<p>The general solution can be written in terms of the eigenvalues (<span class="arithmatex">\(\mathbf{D}\)</span>) and eigenvectors (<span class="arithmatex">\(\mathbf{A}\)</span>),</p>
<div class="arithmatex">\[
\vec{n}(t) = \mathbf{A}\mathbf{D}^t\mathbf{A}^{-1}\vec{n}(0).
\]</div>
<p>As the eigenvalues and eigenvectors are often unobtainable when there are many types of individuals (without specifying parameter values), we often rely on the long-term approximation,</p>
<div class="arithmatex">\[
\vec{n}(t) \approx \lambda_1^t \vec{v}_1 \vec{u}_1 \vec{n}(0).
\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The long-term approximation, <span class="arithmatex">\(\vec{n}(t) = \lambda_1^t \vec{v}_1 \vec{u}_1 \vec{n}(0)\)</span>, is valid as long as the leading eigenvalue, <span class="arithmatex">\(\lambda_1\)</span>, is</p>
<ul>
<li>real (no cycles in long-term)</li>
<li>positive (no oscillations to negative numbers!)</li>
<li>larger than all other eigenvalues (so that we can ignore the other eigenvalues/vectors)</li>
</ul>
<p>Fortunately <em>we are guaranteed all these conditions in our demographic models</em> since all entries of <span class="arithmatex">\(\mathbf{M}\)</span> are non-negative and all entries of <span class="arithmatex">\(\mathbf{M}^t\)</span> are positive for some value of <span class="arithmatex">\(t\)</span>. (This follows from something called the <strong>Perron-Frobenius Theorem</strong>.)</p>
</div>
<p>For this we just need to know the leading eigenvalue (<span class="arithmatex">\(\lambda_1\)</span>) and the corresponding right (<span class="arithmatex">\(\vec{v}_1\)</span>) and left (<span class="arithmatex">\(\vec{u}_1\)</span>) eigenvectors, respectively. (Remember that we have scaled the eigenvectors such that <span class="arithmatex">\(\vec{u}_1\vec{v}_1=1\)</span>.)</p>
<p>These three components (<span class="arithmatex">\(\lambda_1\)</span>, <span class="arithmatex">\(\vec{v}_1\)</span>, <span class="arithmatex">\(\vec{u}_1\)</span>) are the key demographic quantities that we will investigate:</p>
<ul>
<li><span class="arithmatex">\(\lambda_1\)</span> is the <strong>long-term population growth rate</strong></li>
<li><span class="arithmatex">\(\vec{v}_1\)</span> describes the <strong>stable stage-distribution</strong></li>
<li><span class="arithmatex">\(\vec{u}_1\)</span> describes the relative <strong>reproductive values</strong> of each stage</li>
</ul>
<p>The most general demographic model is called <strong>stage-structure</strong>: we consider some finite number of discrete stages that an individual can be in and we use an abitrary matrix of transitions between stages (a <strong>projection matrix</strong>), <span class="arithmatex">\(\mathbf{M}\)</span>, to project how the population size and composition changes over time.</p>
<p>A common special case is <strong>age-structure</strong>: here we define the stages as the number of time steps an individual has been alive for, which leads to a simpler projection matrix (called a <strong>Leslie matrix</strong>) because individuals either transition to the next stage or die.</p>
<p><span id='section2'></span></p>
<h2 id="2-stage-structure">2. Stage-structure</h2>
<hr>

<p>Consider an arbitrary stage-structured population. The long term approximation for its dynamics is <span class="arithmatex">\(\vec{n}(t) \approx \lambda_1^t \vec{v}_1 \vec{u}_1 \vec{n}(0).\)</span> </p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>If we wanted to increase the total population size in the future and we could add one individual to any stage, which stage should it be?</p>
</div>
<p>We want to know what entry of <span class="arithmatex">\(\vec{n}(0)\)</span> to add one to to maximize <span class="arithmatex">\(\vec{n}(t) \approx \lambda^t \vec{v}_1 \vec{u}_1 \vec{n}(0)\)</span>. Adding individuals will not affect the long-term growth rate (<span class="arithmatex">\(\lambda_1\)</span>) or the stable-stage distribution (<span class="arithmatex">\(\vec{v}_1\)</span>). We can therefore only increase <span class="arithmatex">\(\vec{u}_1\vec{n}(0) = u_1 n_1(0) + u_2 n_2(0) + ... + u_m n_m(0)\)</span>. And so we add 1 to the stage with the largest reproductive value, <span class="arithmatex">\(u_i\)</span>.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>If we wanted to increase the long-term population growth rate and we could increase any parameter a little bit, which parameter should it be?</p>
</div>
<p>We want to know how increasing a given parameter of the model, <span class="arithmatex">\(z\)</span>, changes the long-term growth rate, <span class="arithmatex">\(\mathrm{d}\lambda_1/\mathrm{d}z\)</span>, which we call the <strong>sensitivity</strong> of <span class="arithmatex">\(\lambda_1\)</span> to <span class="arithmatex">\(z\)</span>. Unfortunately <span class="arithmatex">\(\lambda_1\)</span> is typically a relatively complicated expression, if attainable at all. Instead, we start with the definition of eigenvalues and eigenvectors to find</p>
<div class="arithmatex">\[
\begin{aligned}
\mathbf{M} \vec{v}_1 &amp;= \lambda_1 \vec{v}_1 \\
\vec{u}_1 \mathbf{M} \vec{v}_1 &amp;= \vec{u}_1 \lambda_1 \vec{v}_1 \\
\frac{\mathrm{d}}{\mathrm{d}z} \left(\vec{u}_1 \mathbf{M} \vec{v}_1 \right)&amp;= \frac{\mathrm{d}}{\mathrm{d}z} \left(\vec{u}_1 \lambda_1 \vec{v}_1 \right)\\
\frac{\mathrm{d}\vec{u}_1}{\mathrm{d}z} \mathbf{M} \vec{v}_1 + \vec{u}_1 \frac{\mathrm{d}\mathbf{M}}{\mathrm{d}z} \vec{v}_1 + \vec{u}_1 \mathbf{M} \frac{\mathrm{d}\vec{v}_1}{\mathrm{d}z} &amp;= \frac{\mathrm{d}\vec{u}_1}{\mathrm{d}z} \lambda_1 \vec{v}_1 + \vec{u}_1 \frac{\mathrm{d}\lambda_1}{\mathrm{d}z} \vec{v}_1 + \vec{u}_1 \lambda_1 \frac{\mathrm{d}\vec{v}_1}{\mathrm{d}z}\\
\vec{u}_1 \frac{\mathrm{d}\mathbf{M}}{\mathrm{d}z} \vec{v}_1 &amp;= \vec{u}_1 \frac{\mathrm{d}\lambda_1}{\mathrm{d}z} \vec{v}_1 \\
\frac{\mathrm{d}\lambda_1}{\mathrm{d}z} &amp;= \frac{\vec{u}_1 \frac{\mathrm{d}\mathbf{M}}{\mathrm{d}z} \vec{v}_1}{\vec{u}_1 \vec{v}_1}.
\end{aligned}\]</div>
<p>This helps because we only have to take the derivative of <span class="arithmatex">\(\mathbf{M}\)</span>. Unfortunately the righthand side is still going to be too complicated to understand in general but we can quickly evaluate the eigenvectors and the derivative of <span class="arithmatex">\(\mathbf{M}\)</span> at some given parameter values.</p>
<h3 id="example-north-atlantic-right-whale">Example: North Atlantic right whale</h3>
<p>Let's consider an example. North Atlantic <a href="https://en.wikipedia.org/wiki/Right_whale">right whales</a> were hunted to near extinction in the 1800s and early 1900s, after which their population size is thought to have <em>slowly</em> recovered (there are less than 400 now, and unfortunately <a href="https://www.fisheries.noaa.gov/species/north-atlantic-right-whale#overview">appear to be in decline again</a>). Because of their long life span, over which survival and reproductive rates vary enormously, a stage-structured model is very appropriate. Below we draw a flow diagram representing all the transitions between calves, sexually immature individuals, sexually mature individuals, and actively reproducing individuals.</p>
<center>
<pre class="mermaid"><code>graph LR;
    C((Calves)) --sIC nC--&gt; I((Immature));
    I --sII nI--&gt; I;
    I --sMI nI--&gt; M((Mature));
    I --sRI nI--&gt; R((Reproductive));
    M --sMM nM--&gt; M;
    M --sRM nM--&gt; R;
    R --sRR nR--&gt; R;
    R --sMR nR--&gt; M;
    R --b nR--&gt; C;</code></pre>
</center>

<p>Converting this flow diagram into a system of recursion equations, <span class="arithmatex">\(\vec{n}(t+1) = \mathbf{M}\vec{n}(t)\)</span>, the projection matrix is</p>
<div class="arithmatex">\[
\mathbf{M} =
\begin{pmatrix}
0 &amp; 0 &amp; 0 &amp; b \\
s_{IC} &amp; s_{II} &amp; 0 &amp; 0\\
0 &amp; s_{MI} &amp; s_{MM} &amp; s_{MR} \\
0 &amp; s_{RI} &amp; s_{RM} &amp; s_{RR}
\end{pmatrix}.
\]</div>
<p>If we now plug in some estimated parameter values from the literature (<span class="arithmatex">\(b=0.3\)</span>, <span class="arithmatex">\(s_{IC}=0.92\)</span>, <span class="arithmatex">\(s_{II}=0.86\)</span>, <span class="arithmatex">\(s_{MI}=0.08\)</span>, <span class="arithmatex">\(s_{MM}=0.8\)</span>, <span class="arithmatex">\(s_{MR}=0.88\)</span>, <span class="arithmatex">\(s_{RI}=0.02\)</span>, <span class="arithmatex">\(s_{RM}=0.19\)</span>, <span class="arithmatex">\(s_{RR}=0\)</span>) we can numerically calculate the three key demographic quantities (see the code below),</p>
<div class="arithmatex">\[
\begin{aligned}
&amp;\lambda_1 \approx 1.003 \\
&amp;\vec{v}_1 \approx \begin{pmatrix} 0.04 \\ 0.23 \\ 0.61 \\ 0.12\end{pmatrix} \\
&amp;\vec{u}_1 \approx \begin{pmatrix} 0.69 &amp; 0.76 &amp; 1.07 &amp; 1.15 \end{pmatrix}.
\end{aligned}
\]</div>
<p>These quantities tells us, for example, that in the long-run the population is predicted to grow (<span class="arithmatex">\(\lambda_1&gt;1\)</span>), the majority of individuals are expected to be mature (the second last entry in <span class="arithmatex">\(\vec{v}_1\)</span> is the largest), and mature and reproductive individuals are expected to have much higher reproductive values than calves and immature individuals (the last two entries in <span class="arithmatex">\(\vec{u}_1\)</span> are much larger than the first two). </p>
<div class="admonition note">
<p class="admonition-title">Caveat</p>
<p>The parameter values above were estimated before the current population decline -- changes in climate and human behaviour, eg boat traffic and fishing, have presumably altered the parameter values, making the predictions less accurate. For example, the increased incidence of entanglement in fishing nets has likely decreased survival rates to the point that the population is now expected to decline. See <a href="https://www.fisheries.noaa.gov/species/north-atlantic-right-whale#overview">here</a> for more info.</p>
</div>
<p>Below we plot the general solution and long-term approximation. Note the quick convergence.</p>
<pre data-executable="true" data-language="python">
b,sic,sii,smi,smm,smr,sri,srm,srr = 0.3,0.92,0.86,0.08,0.8,0.88,0.02,0.19,0 #parameter values

import numpy as np

M = np.array([[0,0,0,b], #projection matrix
              [sic,sii,0,0],
              [0,smi,smm,smr],
              [0,sri,srm,srr]])

# calculate
eigs = np.linalg.eig(M) #eigenvalues and right eigenvectors
ix = np.argmax(np.abs(eigs[0])) #which is leading eigenvalue
l1 = eigs[0][ix] #leading eigenvalue
v1 = eigs[1][:,ix] #leading right eigenvector
v1 = v1/np.sum(v1) #normalized to sum to 1
us = np.linalg.inv(eigs[1]) #left eigenvectors
u1 = us[ix] #leading left eigenvalue
u1 = u1/np.dot(u1,v1) #normalized so u1*v1=1

n0 = np.array([50,50,50,50]) #initial state

def ntfull(t):
    '''full projection'''
    return np.dot(np.linalg.matrix_power(M,t), n0)

def ntapp(t):
    '''long term approximation'''
    return l1**t * v1 * np.dot(u1, n0)

# plot
import matplotlib.pyplot as plt

fig, ax = plt.subplots()

labels = ['calves','immature','mature','reproductive']
colors = plt.get_cmap('tab10')
for i,j in enumerate(range(len(M))): #for each stage
    ax.plot([ntfull(t)[j] for t in range(100)], color=colors(i), label=labels[i])
    ax.plot([ntapp(t)[j] for t in range(100)], color=colors(i), linestyle='--') #long-term approx

ax.legend()
ax.set_xlabel('years')
ax.set_ylabel('number of whales')
plt.show()
</pre>

<p><img alt="png" src="../lecture-10_files/lecture-10_3_0.png" /></p>
<p>Let's now return to our two questions. </p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>If we wanted to increase the total population size in the future and we could add one individual to any stage, which stage should it be?</p>
</div>
<p>The reproductive values for these whales are <span class="arithmatex">\(\vec{u}_1 \approx \begin{pmatrix} 0.69 &amp; 0.76 &amp; 1.07 &amp; 1.15 \end{pmatrix}\)</span>. To maximize population size we should add an individual with the largest reproductive value: a reproductively active individual. This is perhaps not surprising since reproductively active individuals are the only individuals that produce offspring and if we introduced an individual in an earlier stage there is some chance that they would die before becoming reproductively active.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>If we wanted to increase the long-term population growth rate and we could increase any parameter a little bit, which parameter should it be?</p>
</div>
<p>Below we differentiate <span class="arithmatex">\(\mathbf{M}\)</span> with respect to each parameter, <span class="arithmatex">\(\frac{\mathrm{d}\mathbf{M}}{\mathrm{d}z}\)</span>, and then numerically calculate the sensitivities, <span class="arithmatex">\(\frac{\vec{u}_1 \frac{\mathrm{d}\mathbf{M}}{\mathrm{d}z} \vec{v}_1}{\vec{u}_1 \vec{v}_1}\)</span>, at the current parameter estimates. We see that increasing the fraction of mature individuals that survive to become reproductively active, <span class="arithmatex">\(s_{RM}\)</span>, has the largest effect. This makes good sense because increasing <span class="arithmatex">\(s_{RM}\)</span> increases the rate at which the most populous stage (from <span class="arithmatex">\(\vec{v}_1\)</span>) transitions to the stage with the highest reproductive value (from <span class="arithmatex">\(\vec{u}_1\)</span>).</p>
<pre data-executable="true" data-language="python">
import numpy as np
from sympy import *
import matplotlib.pyplot as plt

# differentiate M symbolically
b,sic,sii,smi,smm,smr,sri,srm,srr = symbols('b,s_ic,s_ii,s_mi,s_mm,s_mr,s_ri,s_rm,s_rr')
M = Matrix([[0,0,0,b], #projection matrix
            [sic,sii,0,0],
            [0,smi,smm,smr],
            [0,sri,srm,srr]])
dMdzs = [diff(M,z) for z in [b,sic,sii,smi,smm,smr,sri,srm,srr]] #derivatives of M with respect to parameters

# numerically get eigenvectors
param_vals = {'b':0.3,'s_ic':0.92,'s_ii':0.86,'s_mi':0.08,'s_mm':0.8,'s_mr':0.88,'s_ri':0.02,'s_rm':0.19,'s_rr':0} #parameter values
numeric_M = np.array(M.subs(param_vals),dtype=float)
eigs = np.linalg.eig(numeric_M) #eigenvalues and right eigenvectors
ix = np.argmax(np.abs(eigs[0])) #which is leading eigenvalue
v1 = eigs[1][:,ix] #leading right eigenvector
v1 = v1/np.sum(v1) #normalized to sum to 1
us = np.linalg.inv(eigs[1]) #left eigenvectors
u1 = us[ix] #leading left eigenvalue
u1 = u1/np.dot(u1,v1) #normalized so u1*v1=1

# change in leading eigenvalue with increase in each parameter
dl1dzs = [np.matmul(np.matmul(u1,dMdz),v1)/np.matmul(u1,v1) for dMdz in dMdzs] 

# plot
plt.bar(['$b$','$S_{IC}$','$S_{II}$','$S_{MI}$','$S_{MM}$','$S_{MR}$','$S_{RI}$','$S_{RM}$','$S_{RR}$'],dl1dzs)
plt.xlabel('parameter, $z$')
plt.ylabel('sensitivity, $d\lambda_1/dz$')
plt.show()
</pre>

<p><img alt="png" src="../lecture-10_files/lecture-10_5_0.png" /></p>
<p><span id='section3'></span></p>
<h2 id="3-age-structure">3. Age-structure</h2>
<hr>

<p>Now let's look at the special case of <strong>age-structure</strong>. Here individuals in stage <span class="arithmatex">\(i\)</span> at time <span class="arithmatex">\(t\)</span> can only contribute to stage <span class="arithmatex">\(i+1\)</span> (survival) and stage <span class="arithmatex">\(1\)</span> (reproduction) at time <span class="arithmatex">\(t+1\)</span>.</p>
<center>
<pre class="mermaid"><code>graph LR;
    1((1)) --p1 n1--&gt; 2((2));    
    1 --m1 n1--&gt; 1;
    2 --p2 n2--&gt; 3((3));
    2 --m2 n2--&gt; 1;    
    3 --p3 n3--&gt; 4((4));
    3 --m3 n3--&gt; 1;
    4 --m4 n4--&gt; 1;</code></pre>
</center>

<p>Because of this, the projection matrix is simpler in the sense that it contains more zeros and has non-zero entries in very specific places,</p>
<div class="arithmatex">\[
\mathbf{L} = 
\begin{pmatrix}  
m_1 &amp; m_2 &amp; m_3 &amp; \cdots &amp; m_d \\
p_1 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\
0 &amp; p_2 &amp; 0 &amp; \cdots &amp; 0 \\
\vdots &amp;  &amp; \vdots &amp;  &amp; \vdots \\  
0 &amp; \cdots &amp; 0 &amp; p_{d-1} &amp; 0\\
\end{pmatrix}.
\]</div>
<p>We call this a <strong>Leslie matrix</strong> and often denote it with <span class="arithmatex">\(\mathbf{L}\)</span>. The first row contains the fecundities of each age group, <span class="arithmatex">\(m_i\)</span>, while the entries immediately below the diagonal give the fraction of individuals that survive each age group, <span class="arithmatex">\(p_i\)</span>.</p>
<p>Because of the structure of the Leslie matrix, many expressions are now simpler. For example, the characteristic polynomial, <span class="arithmatex">\(\mathrm{Det}(\mathbf{L}-\mathbf{I}\lambda)=0\)</span>, which we use to get the eigenvalues, can be calculated using the first row. After rearranging we get what is known as the <strong>Euler-Lotka equation</strong>,</p>
<div class="arithmatex">\[
1 = \sum_{i=1}^{d} \frac{l_i m_i}{\lambda^i},
\]</div>
<p>where <span class="arithmatex">\(l_1 = 1\)</span>, <span class="arithmatex">\(l_i = p_1 p_2 \cdots p_{i-1}\)</span> is the fraction of individuals that survive from birth to age <span class="arithmatex">\(i\)</span> and <span class="arithmatex">\(d\)</span> is the number of ages (ie, <span class="arithmatex">\(\mathbf{L}\)</span> is a <span class="arithmatex">\(d\times d\)</span> matrix). Given the <span class="arithmatex">\(l_i\)</span> and <span class="arithmatex">\(m_i\)</span> we can use this equation to find the long-term population growth rate, <span class="arithmatex">\(\lambda_1\)</span>.</p>
<h3 id="example-stickleback">Example: stickleback</h3>
<p>For example, let's look at a model of <a href="https://en.wikipedia.org/wiki/Stickleback">stickleback</a>, a small fish. We assume stickleback do not live more than 4 years and estimate the Leslie matrix as</p>
<div class="arithmatex">\[
\mathbf{L} = 
\begin{pmatrix}
2 &amp; 3 &amp; 4 &amp; 4\\
0.6 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0.3 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0.1 &amp; 0
\end{pmatrix}.
\]</div>
<p>The Euler-Lotka equation is then</p>
<div class="arithmatex">\[
\begin{aligned}
1 &amp;= \sum_{i=1}^{4} \frac{l_i m_i}{\lambda^i}\\
1 &amp;= \frac{l_1 m_1}{\lambda} + \frac{l_2 m_2}{\lambda^2} + \frac{l_3 m_3}{\lambda^3} + \frac{l_4 m_4}{\lambda^4}\\
1 &amp;= \frac{2}{\lambda} + \frac{1.8}{\lambda^2} + \frac{0.72}{\lambda^3} + \frac{0.072}{\lambda^4}. 
\end{aligned}
\]</div>
<p>This can be numerically solved to give our four eigenvalues: <span class="arithmatex">\(\lambda\approx2.75, -0.3 \pm 0.3i, -0.14\)</span>. The long-term growth rate is the eigenvalue with the largest absolute value, <span class="arithmatex">\(\lambda_1=2.75\)</span>.</p>
<p>Below we plot the general solution and long-term approximation. As expected based on <span class="arithmatex">\(\lambda_1=2.75\)</span>, the population grows very quickly (note the log scale on the y-axis).</p>
<pre data-executable="true" data-language="python">
m1,m2,m3,m4,p1,p2,p3 = 2,3,4,4,0.6,0.3,0.1 #parameter values

import numpy as np

M = np.array([[m1,m2,m3,m4], #projection matrix
              [p1,0,0,0],
              [0,p2,0,0],
              [0,0,p3,0]])

# calculate
eigs = np.linalg.eig(M) #eigenvalues and right eigenvectors
ix = np.argmax(np.abs(eigs[0])) #which is leading eigenvalue
l1 = eigs[0][ix] #leading eigenvalue
v1 = eigs[1][:,ix] #leading right eigenvector
v1 = v1/np.sum(v1) #normalized to sum to 1
us = np.linalg.inv(eigs[1]) #left eigenvectors
u1 = us[ix] #leading left eigenvalue
u1 = u1/np.dot(u1,v1) #normalized so u1*v1=1

n0 = np.array([25,25,25,25]) #initial state

def ntfull(t):
    '''full projection'''
    return np.dot(np.linalg.matrix_power(M,t), n0)

def ntapp(t):
    '''long term approximation'''
    return l1**t * v1 * np.dot(u1, n0)

# plot
import matplotlib.pyplot as plt

fig, ax = plt.subplots()

labels = ['age 1','age 2','age 3','age 4']
colors = plt.get_cmap('tab10')
for i,j in enumerate(range(len(M))): #for each stage
    ax.plot([ntfull(t)[j] for t in range(10)], color=colors(i), label=labels[i])
    ax.plot([ntapp(t)[j] for t in range(10)], color=colors(i), linestyle='--') #long-term approx

ax.legend()
ax.set_xlabel('years')
ax.set_ylabel('number of stickleback')
ax.set_yscale('log')
plt.show()
</pre>

<div class="highlight"><pre><span></span><code>/Users/mmosmond/.virtualenvs/eeb430/lib/python3.7/site-packages/matplotlib/cbook/__init__.py:1298: ComplexWarning: Casting complex values to real discards the imaginary part
  return np.asarray(x, float)
</code></pre></div>
<p><img alt="png" src="../lecture-10_files/lecture-10_7_1.png" /></p>
<p><span id='section4'></span></p>
<h2 id="4-summary">4. Summary</h2>
<hr>

<ul>
<li>linear multivariate models can describe the <strong>demography</strong> of a population composed of multiple types of individuals (stages or ages)</li>
<li>in this case the terms in the long-term approximation are<ul>
<li><span class="arithmatex">\(\lambda_1\)</span>:  <strong>long-term population growth rate</strong></li>
<li><span class="arithmatex">\(\vec{v}_1\)</span>: the <strong>stable stage-distribution</strong></li>
<li><span class="arithmatex">\(\vec{u}_1\)</span>: the relative <strong>reproductive values</strong> of each (st)age</li>
</ul>
</li>
<li>adding individuals with larger reproductive value increases future population size more</li>
<li>the effect of each parameter on the long-term growth rate (its <strong>sensitivity</strong>) can be calculated as <span class="arithmatex">\(\frac{\mathrm{d}\lambda_1}{\mathrm{d}z} = \frac{\vec{u}_1 \frac{\mathrm{d}\mathbf{M}}{\mathrm{d}z} \vec{v}_1}{\vec{u}_1 \vec{v}_1}\)</span></li>
<li>with age-structure the projection matrix <span class="arithmatex">\(\mathbf{M}\)</span> takes a special form (Leslie matrix) allowing the eigenvalues to be found with the Euler-Lotka equation, <span class="arithmatex">\(1 = \sum_{i=1}^{d} \frac{l_i m_i}{\lambda^i}\)</span></li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "navigation.tabs"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>